<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to SoilProfileCollection Objects</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to SoilProfileCollection
Objects</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This is a basic introduction to the
<code>SoilProfileCollection</code> class object defined in the
<code>aqp</code> package for <strong>R</strong>.</p>
<p>The <code>SoilProfileCollection</code> class was designed to simplify
the process of working with the collection of data associated with soil
profiles: site-level data, horizon-level data, spatial data, diagnostic
horizon data, metadata, etc.</p>
<p>Examples listed below are meant to be copied/pasted from this
document and interactively run within <strong>R</strong>. Comments
(preceded by <code>#</code> symbol) briefly describe what the code in
each line does. Further documentation on objects and functions from the
<code>aqp</code> package can be accessed by typing
<code>help(aqp)</code> (or more generally, <code>?function_name</code>)
at the <strong>R</strong> console.</p>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<p>In this tutorial we will use some sample data included with the
<code>aqp</code> package, based on characterization data from 10 soils
sampled on serpentinitic parent material as described in <a href="https://acsess.onlinelibrary.wiley.com/doi/10.2136/sssaj2008.0087">McGahan
et al, 2009</a>.</p>
<p>To begin you will load required packages. You may have to first
install these if missing:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># install CRAN release + dependencies</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;aqp&#39;</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;remotes&#39;</span>, <span class="at">dependencies =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># install latest version from GitHub</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;ncss-tech/aqp&quot;</span>, <span class="at">dependencies =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(aqp)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(lattice)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># load sample data set, a data.frame object with horizon-level data from 10 profiles</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">data</span>(sp4)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">str</span>(sp4)</span></code></pre></div>
<pre><code>#&gt; &#39;data.frame&#39;:    30 obs. of  13 variables:
#&gt;  $ id         : chr  &quot;colusa&quot; &quot;colusa&quot; &quot;colusa&quot; &quot;colusa&quot; ...
#&gt;  $ name       : chr  &quot;A&quot; &quot;ABt&quot; &quot;Bt1&quot; &quot;Bt2&quot; ...
#&gt;  $ top        : int  0 3 8 30 0 9 0 4 13 0 ...
#&gt;  $ bottom     : int  3 8 30 42 9 34 4 13 40 6 ...
#&gt;  $ K          : num  0.3 0.2 0.1 0.1 0.2 0.3 0.2 0.6 0.8 0.4 ...
#&gt;  $ Mg         : num  25.7 23.7 23.2 44.3 21.9 18.9 12.1 12.1 17.7 16.4 ...
#&gt;  $ Ca         : num  9 5.6 1.9 0.3 4.4 4.5 1.4 7 4.4 24.1 ...
#&gt;  $ CEC_7      : num  23 21.4 23.7 43 18.8 27.5 23.7 18 20 31.1 ...
#&gt;  $ ex_Ca_to_Mg: num  0.35 0.23 0.08 0.01 0.2 0.2 0.58 0.51 0.25 1.47 ...
#&gt;  $ sand       : int  46 42 40 27 54 49 43 36 27 43 ...
#&gt;  $ silt       : int  33 31 28 18 20 18 55 49 45 42 ...
#&gt;  $ clay       : int  21 27 32 55 25 34 3 15 27 15 ...
#&gt;  $ CF         : num  0.12 0.27 0.27 0.16 0.55 0.84 0.5 0.75 0.67 0.02 ...</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># optionally read about it...</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># ?sp4</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># upgrade to SoilProfileCollection</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co"># &#39;id&#39; is the name of the column containing the profile ID</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co"># &#39;top&#39; is the name of the column containing horizon upper boundaries</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co"># &#39;bottom&#39; is the name of the column containing horizon lower boundaries</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">depths</span>(sp4) <span class="ot">&lt;-</span> id <span class="sc">~</span> top <span class="sc">+</span> bottom</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co"># define &quot;horizon designation&quot; column name for the collection</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="fu">hzdesgnname</span>(sp4) <span class="ot">&lt;-</span> <span class="st">&#39;name&#39;</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co"># check it out:</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="fu">class</span>(sp4)</span></code></pre></div>
<pre><code>#&gt; [1] &quot;SoilProfileCollection&quot;
#&gt; attr(,&quot;package&quot;)
#&gt; [1] &quot;aqp&quot;</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">print</span>(sp4)</span></code></pre></div>
<pre><code>#&gt; SoilProfileCollection with 10 profiles and 30 horizons
#&gt; profile ID: id  |  horizon ID: hzID 
#&gt; Depth range: 16 - 49 cm
#&gt; 
#&gt; ----- Horizons (6 / 30 rows  |  10 / 14 columns) -----
#&gt;      id hzID top bottom name   K   Mg  Ca CEC_7 ex_Ca_to_Mg
#&gt;  colusa    1   0      3    A 0.3 25.7 9.0  23.0        0.35
#&gt;  colusa    2   3      8  ABt 0.2 23.7 5.6  21.4        0.23
#&gt;  colusa    3   8     30  Bt1 0.1 23.2 1.9  23.7        0.08
#&gt;  colusa    4  30     42  Bt2 0.1 44.3 0.3  43.0        0.01
#&gt;   glenn    5   0      9    A 0.2 21.9 4.4  18.8        0.20
#&gt;   glenn    6   9     34   Bt 0.3 18.9 4.5  27.5        0.20
#&gt; [... more horizons ...]
#&gt; 
#&gt; ----- Sites (6 / 10 rows  |  1 / 1 columns) -----
#&gt;         id
#&gt;     colusa
#&gt;      glenn
#&gt;      kings
#&gt;   mariposa
#&gt;  mendocino
#&gt;       napa
#&gt; [... more sites ...]
#&gt; 
#&gt; Spatial Data:
#&gt; [EMPTY]</code></pre>
</div>
<div id="object-creation" class="section level1">
<h1>Object Creation</h1>
<p><code>SoilProfileCollection</code> objects are typically created by
“promoting” <code>data.frame</code> objects (rectangular tables of data)
that contain at least three essential columns:</p>
<ol style="list-style-type: decimal">
<li>an ID column uniquely identifying groups of horizons
(e.g. pedons)</li>
<li>horizon top boundaries</li>
<li>horizon bottom boundaries</li>
</ol>
<p>The <code>data.frame</code> is sorted internally according to the
profile ID and horizon top boundary. Formula notation is used to define
the columns used to promote a <code>data.frame</code> object:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>idcolumn <span class="sc">~</span> hz_top_column <span class="sc">+</span> hz_bottom_column</span></code></pre></div>
<div id="rapid-templating" class="section level2">
<h2>Rapid Templating</h2>
<p>Small collections of soil profiles can be described using text
“templates” and <code>quickSPC()</code>. Templates take the form of:</p>
<ul>
<li><p><code>ID:AAA|BBB|CCCCCC</code>: relative thickness specified by
horizon designations, split by “|” symbol</p></li>
<li><p><code>ID:A-B-C</code>: horizons of random thickness specified by
horizon designations, split by “-” symbol</p></li>
</ul>
<p>The “ID:” prefix is optional, with unique IDs generated by the digest
package when omitted.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># character vector of horizon templates</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co"># must all use the same formatting</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>  <span class="st">&#39;P1:AAA|BwBwBwBw|CCCCCCC|CdCdCdCd&#39;</span>,</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>  <span class="st">&#39;P2:ApAp|AE|BhsBhs|Bw1Bw1|Bw2|CCCCCCC&#39;</span>,</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>  <span class="st">&#39;P3:A|Bt1Bt1Bt1|Bt2Bt2Bt2|Bt3|Cr|RRRRRR&#39;</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co"># each horizon label is &#39;10&#39; depth-units (default)</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">quickSPC</span>(x)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co"># sketch profiles</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">plotSPC</span>(s, <span class="at">name.style =</span> <span class="st">&#39;center-center&#39;</span>, </span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>        <span class="at">cex.names =</span> <span class="dv">1</span>, <span class="at">depth.axis =</span> <span class="cn">FALSE</span>, </span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>        <span class="at">hz.depths =</span> <span class="cn">TRUE</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="accessing-setting-and-replacing-data" class="section level1">
<h1>Accessing, Setting, and Replacing Data</h1>
<p>“Accessor” functions are used to extract specific components from
within <code>SoilProfileCollection</code> objects.</p>
<ul>
<li><p>Methods that return a column name. These are useful for
extracting depths, horizon designations, IDs, etc. before taking an SPC
apart for a specific task.</p></li>
<li><p><code>idname(sp4)</code>: extract profile ID name (column name
used to init SPC)</p></li>
<li><p><code>horizonDepths(sp4)</code>: horizon top / bottom depth names
(used to init SPC)</p></li>
<li><p><code>hzidname(sp4)</code>: horizon ID name (typically
automatically built at init time)</p></li>
<li><p><code>hzdesgnname(sp4)</code>: horizon designation name (if
set)</p></li>
<li><p><code>hztexclname(sp4)</code>: horizon texture class name (if
set)</p></li>
<li><p>Methods that return a vector of values.</p></li>
<li><p><code>profile_id(sp4)</code>: profile IDs, in order</p></li>
<li><p><code>hzID(sp4)</code>: horizon IDs, in order</p></li>
<li><p><code>hzDesgn(sp4)</code>: horizon designations, in
order</p></li>
<li><p>Methods that return site/horizon attribute column names.</p></li>
<li><p><code>names(sp4)</code>: site + horizon names concatenated into a
single vector</p></li>
<li><p><code>horizonNames(sp4)</code>: horizon names</p></li>
<li><p><code>siteNames(sp4)</code>: site names</p></li>
<li><p>Profile and horizon totals.</p></li>
<li><p><code>length(sp4)</code>: number of profiles in
collection</p></li>
<li><p><code>nrow(sp4)</code>: number of horizons in collection</p></li>
<li><p>Other methods.</p></li>
<li><p><code>depth_units(sp4)</code>: defaults to ‘cm’ at SPC
creation</p></li>
<li><p><code>metadata(sp4)</code>: returns <code>list</code> object with
base + optional (user-defined) metadata elements</p></li>
</ul>
</div>
<div id="horizon-and-site-data" class="section level1">
<h1>Horizon and Site Data</h1>
<p>Horizon data and information about key columns (unique profile ID and
depths) are the primary input to the methods provided to create the
object. Site data can be derived from unique profile-specific values
within the input horizon data, or joined in from an external source
based on profile ID.</p>
<p>Both site and horizon data are stored as <code>data.frame</code>
within the SoilProfileCollection; with one or more rows (per profile ID)
in the horizon table and one row (per profile ID) in the site table. The
SoilProfileCollection also supports <code>data.table</code>, or
<code>tibble</code> objects in the <code>data.frame</code> slots.</p>
<p>Columns from site or horizon tables can be accessed with the
<code>$</code> syntax notation, similar to the <code>data.frame</code>.
New data can be assigned to either table in the same manner, as long as
the length of the new data is:</p>
<ol style="list-style-type: decimal">
<li>same length as the number of profiles in the collection (target is
the site table)</li>
<li>same length as the number of horizons in the collection (target is
the horizon table)</li>
<li>length 1; and selecting the target table requires
<code>site(object)$new_column &lt;- new_value</code> for new site data
and <code>horizons(object)$new_column &lt;- new value</code> for
horizon</li>
</ol>
<p>Assignment of new data to existing or new attributes can proceed as
follows.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># site-level (based on length of assigned data == number of profiles)</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>sp4<span class="sc">$</span>elevation <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">length</span>(sp4), <span class="at">mean =</span> <span class="dv">1000</span>, <span class="at">sd =</span> <span class="dv">150</span>) </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># horizon-level (calculated from two horizon-level columns)</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>sp4<span class="sc">$</span>thickness <span class="ot">&lt;-</span> sp4<span class="sc">$</span>bottom <span class="sc">-</span> sp4<span class="sc">$</span>top </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co"># extraction of specific attributes by name</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>sp4<span class="sc">$</span>clay <span class="co"># vector of clay content (horizon data)</span></span></code></pre></div>
<pre><code>#&gt;  [1] 21 27 32 55 25 34  3 15 27 32 25 31 33 13 21 23 15 17 12 19 14 14 22 25 40 51 67 24 25 32</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>sp4<span class="sc">$</span>elevation <span class="co"># vector of simulated elevation (site data)</span></span></code></pre></div>
<pre><code>#&gt;  [1] 1151.2484 1087.3996 1004.3803  785.1715 1086.1881 1036.3093 1110.6203  919.8431 1133.1459
#&gt; [10] 1036.5984</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># unit-length value explicitly targeting site data</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">site</span>(sp4)<span class="sc">$</span>collection_id <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co"># assign a single single value into horizon-level attributes</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>sp4<span class="sc">$</span>constant <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="at">times =</span> <span class="fu">nrow</span>(sp4))</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co"># unit-length value explicitly targeting horizon data</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="fu">horizons</span>(sp4)<span class="sc">$</span>analysis_group <span class="ot">&lt;-</span> <span class="st">&quot;SERP&quot;</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co"># _moves_ the named column from horizon to site</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="fu">site</span>(sp4) <span class="ot">&lt;-</span> <span class="er">~</span> constant </span></code></pre></div>
<p>Horizon and site data can be modified via extraction to
<code>data.frame</code> followed by replacement (horizon data) or join
(site data). Note that while this approach gives the most flexibility,
it is also the most dangerous–replacement of horizon data with new data
that don’t exactly conform to the original sorting may corrupt your
<code>SoilProfileCollection</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># extract horizon data to data.frame</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">horizons</span>(sp4)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># add a new column and save back to original object</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>h<span class="sc">$</span>random.numbers <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">nrow</span>(h), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co"># _replace_ original horizon data with modified version</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="fu">replaceHorizons</span>(sp4) <span class="ot">&lt;-</span> h</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co"># extract site data to data.frame</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">site</span>(sp4)</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="co"># add a fake group to the site data</span></span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>s<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>), <span class="at">length.out =</span> <span class="fu">nrow</span>(s)))</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a><span class="co"># join new site data with previous data: old data are _not_ replaced</span></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="fu">site</span>(sp4) <span class="ot">&lt;-</span> s</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a>sp4</span></code></pre></div>
<pre><code>#&gt; SoilProfileCollection with 10 profiles and 30 horizons
#&gt; profile ID: id  |  horizon ID: hzID 
#&gt; Depth range: 16 - 49 cm
#&gt; 
#&gt; ----- Horizons (6 / 30 rows  |  10 / 17 columns) -----
#&gt;      id hzID top bottom name   K   Mg  Ca CEC_7 ex_Ca_to_Mg
#&gt;  colusa    1   0      3    A 0.3 25.7 9.0  23.0        0.35
#&gt;  colusa    2   3      8  ABt 0.2 23.7 5.6  21.4        0.23
#&gt;  colusa    3   8     30  Bt1 0.1 23.2 1.9  23.7        0.08
#&gt;  colusa    4  30     42  Bt2 0.1 44.3 0.3  43.0        0.01
#&gt;   glenn    5   0      9    A 0.2 21.9 4.4  18.8        0.20
#&gt;   glenn    6   9     34   Bt 0.3 18.9 4.5  27.5        0.20
#&gt; [... more horizons ...]
#&gt; 
#&gt; ----- Sites (6 / 10 rows  |  5 / 5 columns) -----
#&gt;         id elevation collection_id constant group
#&gt;     colusa 1151.2484             1        1     A
#&gt;      glenn 1087.3996             1        1     B
#&gt;      kings 1004.3803             1        1     A
#&gt;   mariposa  785.1715             1        1     B
#&gt;  mendocino 1086.1881             1        1     A
#&gt;       napa 1036.3093             1        1     B
#&gt; [... more sites ...]
#&gt; 
#&gt; Spatial Data:
#&gt; [EMPTY]</code></pre>
</div>
<div id="diagnostic-horizons" class="section level1">
<h1>Diagnostic Horizons</h1>
<p>Diagnostic horizons typically span several genetic horizons and may
or may not be present in every profile.</p>
<p>To accommodate the wide range of possibilities, diagnostic horizon
data are stored as a <code>data.frame</code> in “long format”: each row
corresponds to a diagnostic feature in a single profile, identified with
a column matching the ID column used to initialize the
<code>SoilProfileCollection</code> object and a label reflecting the
feature kind.</p>
<p>For diagnostic horizon data there are no restrictions on data
content, as long as each row has an ID that exists within the
collection. Be sure to use the ID column name that was used to
initialize the SoilProfileCollection object.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>dh <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>  <span class="at">id =</span> <span class="st">&#39;colusa&#39;</span>,</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="at">kind =</span> <span class="st">&#39;argillic&#39;</span>,</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>  <span class="at">top =</span> <span class="dv">8</span>,</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  <span class="at">bottom =</span> <span class="dv">42</span>,</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>)</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co"># overwrite any existing diagnostic horizon data</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="fu">diagnostic_hz</span>(sp4) <span class="ot">&lt;-</span> dh</span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co"># append to diagnostic horizon data</span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a>dh <span class="ot">&lt;-</span> <span class="fu">diagnostic_hz</span>(sp4)</span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a>dh.new <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a>  <span class="at">id =</span> <span class="st">&#39;napa&#39;</span>,</span>
<span id="cb18-16"><a href="#cb18-16" tabindex="-1"></a>  <span class="at">kind =</span> <span class="st">&#39;argillic&#39;</span>,</span>
<span id="cb18-17"><a href="#cb18-17" tabindex="-1"></a>  <span class="at">top =</span> <span class="dv">6</span>,</span>
<span id="cb18-18"><a href="#cb18-18" tabindex="-1"></a>  <span class="at">bottom =</span> <span class="dv">20</span>,</span>
<span id="cb18-19"><a href="#cb18-19" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb18-20"><a href="#cb18-20" tabindex="-1"></a>)</span>
<span id="cb18-21"><a href="#cb18-21" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" tabindex="-1"></a><span class="co"># overwrite existing diagnostic horizon data with appended data</span></span>
<span id="cb18-23"><a href="#cb18-23" tabindex="-1"></a><span class="fu">diagnostic_hz</span>(sp4) <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dh, dh.new)</span></code></pre></div>
</div>
<div id="root-restrictive-features" class="section level1">
<h1>Root Restrictive Features</h1>
<p>Features that restrict root entry (fine or very fine roots) are
commonly used to estimate <em>functional</em> soil depth. Restrictive
features include salt accumulations, duripans, fragipans, paralithic
materials, lithic contact, or an abrupt change in chemical property.</p>
<p>Not all soils have restrictive features, therefore these data are
stored as a <code>data.frame</code> in “long format”. Each row
corresponds to a restrictive feature, associated depths, and identified
by <code>profile_id()</code>. There may be more than one restrictive
feature per soil profile.</p>
<p>The example data <code>sp4</code> does not describe the restrictive
features, so we will simulate some at the bottom of each profile +
20cm.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># get the depth of each profile</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>rf.top <span class="ot">&lt;-</span> <span class="fu">profileApply</span>(sp4, max)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>rf.bottom <span class="ot">&lt;-</span> rf.top <span class="sc">+</span> <span class="dv">20</span></span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a><span class="co"># the profile IDs can be extracted from the names attribute</span></span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>pIDs <span class="ot">&lt;-</span> <span class="fu">names</span>(rf.top)</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a><span class="co"># note: profile IDs must be stored in a column named for idname(sp4) -&gt; &#39;id&#39;</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>rf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  <span class="at">id =</span> pIDs, </span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  <span class="at">top =</span> rf.top, </span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>  <span class="at">bottom =</span> rf.bottom, </span>
<span id="cb19-13"><a href="#cb19-13" tabindex="-1"></a>  <span class="at">kind =</span> <span class="st">&#39;fake&#39;</span>,</span>
<span id="cb19-14"><a href="#cb19-14" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb19-15"><a href="#cb19-15" tabindex="-1"></a>)</span>
<span id="cb19-16"><a href="#cb19-16" tabindex="-1"></a></span>
<span id="cb19-17"><a href="#cb19-17" tabindex="-1"></a><span class="co"># overwrite any existing diagnostic horizon data</span></span>
<span id="cb19-18"><a href="#cb19-18" tabindex="-1"></a><span class="fu">restrictions</span>(sp4) <span class="ot">&lt;-</span> rf</span>
<span id="cb19-19"><a href="#cb19-19" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb19-21"><a href="#cb19-21" tabindex="-1"></a><span class="fu">restrictions</span>(sp4)</span></code></pre></div>
<pre><code>#&gt;                id top bottom kind
#&gt; 1          colusa  42     62 fake
#&gt; 2           glenn  34     54 fake
#&gt; 3           kings  40     60 fake
#&gt; 4        mariposa  49     69 fake
#&gt; 5       mendocino  30     50 fake
#&gt; 6            napa  20     40 fake
#&gt; 7      san benito  20     40 fake
#&gt; 8          shasta  40     60 fake
#&gt; 9  shasta-trinity  40     60 fake
#&gt; 10         tehama  16     36 fake</code></pre>
</div>
<div id="object-metadata" class="section level1">
<h1>Object Metadata</h1>
<p>SoilProfileCollection metadata can be extracted and set using the
<code>metadata()</code> and <code>metadata&lt;-</code> methods.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># metadata structure</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">metadata</span>(sp4))</span></code></pre></div>
<pre><code>#&gt; List of 6
#&gt;  $ aqp_df_class    : chr &quot;data.frame&quot;
#&gt;  $ aqp_group_by    : chr &quot;&quot;
#&gt;  $ aqp_hzdesgn     : chr &quot;name&quot;
#&gt;  $ aqp_hztexcl     : chr &quot;&quot;
#&gt;  $ depth_units     : chr &quot;cm&quot;
#&gt;  $ stringsAsFactors: logi FALSE</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># alter the depth unit metadata attribute</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="fu">depth_units</span>(sp4) <span class="ot">&lt;-</span> <span class="st">&#39;inches&#39;</span> <span class="co"># units are really &#39;cm&#39;</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co"># add or replace custom metadata</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="fu">metadata</span>(sp4)<span class="sc">$</span>describer <span class="ot">&lt;-</span> <span class="st">&#39;DGM&#39;</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="fu">metadata</span>(sp4)<span class="sc">$</span>date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="st">&#39;2009-01-01&#39;</span>)</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="fu">metadata</span>(sp4)<span class="sc">$</span>citation <span class="ot">&lt;-</span> <span class="st">&#39;McGahan, D.G., Southard, R.J, Claassen, V.P. 2009. Plant-Available Calcium Varies Widely in Soils on Serpentinite Landscapes. Soil Sci. Soc. Am. J. 73: 2087-2095.&#39;</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co"># check new values have been added</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">metadata</span>(sp4))</span></code></pre></div>
<pre><code>#&gt; List of 9
#&gt;  $ aqp_df_class    : chr &quot;data.frame&quot;
#&gt;  $ aqp_group_by    : chr &quot;&quot;
#&gt;  $ aqp_hzdesgn     : chr &quot;name&quot;
#&gt;  $ aqp_hztexcl     : chr &quot;&quot;
#&gt;  $ depth_units     : chr &quot;inches&quot;
#&gt;  $ stringsAsFactors: logi FALSE
#&gt;  $ describer       : chr &quot;DGM&quot;
#&gt;  $ date            : Date[1:1], format: &quot;2009-01-01&quot;
#&gt;  $ citation        : chr &quot;McGahan, D.G., Southard, R.J, Claassen, V.P. 2009. Plant-Available Calcium Varies Widely in Soils on Serpentini&quot;| __truncated__</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># fix depth units, set back to &#39;cm&#39;</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">depth_units</span>(sp4) <span class="ot">&lt;-</span> <span class="st">&#39;cm&#39;</span></span></code></pre></div>
</div>
<div id="spatial-data" class="section level1">
<h1>Spatial Data</h1>
<p>Spatial data and metadata can be stored within a
<code>SoilProfileCollection</code> object. To initialize a “spatial”
SoilProfileCollection, use <code>initSpatial()&lt;-</code> method. This
allows you to specify which columns contain the geometry and optionally
the Coordinate Reference System of those data. The SoilProfileCollection
stores two metadata entries: <code>coordinates</code> and
<code>crs</code> which refer to the column names containing geometric
data and the CRS, respectively.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># generate some fake coordinates as site level attributes</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>sp4<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">length</span>(sp4), <span class="at">mean =</span> <span class="dv">354000</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>sp4<span class="sc">$</span>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="fu">length</span>(sp4), <span class="at">mean =</span> <span class="dv">4109533</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co"># initialize spatial coordinates (CRS optional)</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="fu">initSpatial</span>(sp4, <span class="at">crs =</span> <span class="st">&quot;EPSG:26911&quot;</span>) <span class="ot">&lt;-</span> <span class="er">~</span> x <span class="sc">+</span> y</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co"># extract coordinates as matrix</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="fu">getSpatial</span>(sp4)</span></code></pre></div>
<pre><code>#&gt;              x       y
#&gt;  [1,] 353942.5 4109816
#&gt;  [2,] 353851.7 4109607
#&gt;  [3,] 353977.7 4109595
#&gt;  [4,] 353873.3 4109560
#&gt;  [5,] 353993.9 4109504
#&gt;  [6,] 354125.8 4109574
#&gt;  [7,] 354156.8 4109497
#&gt;  [8,] 353992.0 4109350
#&gt;  [9,] 354001.1 4109447
#&gt; [10,] 353814.1 4109546</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># get/set spatial reference system using prj()&lt;-</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="fu">prj</span>(sp4) <span class="ot">&lt;-</span> <span class="st">&#39;+proj=utm +zone=11 +datum=NAD83&#39;</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co"># return CRS information</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="fu">prj</span>(sp4)</span></code></pre></div>
<pre><code>#&gt; [1] &quot;+proj=utm +zone=11 +datum=NAD83&quot;</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">requireNamespace</span>(<span class="st">&quot;sf&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="co"># extract spatial data + site level attributes in new spatial object</span></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  sp4.sp <span class="ot">&lt;-</span> <span class="fu">as</span>(sp4, <span class="st">&#39;SpatialPointsDataFrame&#39;</span>)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  sp4.sf <span class="ot">&lt;-</span> <span class="fu">as</span>(sp4, <span class="st">&#39;sf&#39;</span>)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="validity-and-horizon-logic" class="section level1">
<h1>Validity and Horizon Logic</h1>
<p>There are several SoilProfileCollection methods defined to identify
corrupted objects/bad depth logic and fix them.</p>
<p>Usually an “invalid” or “corrupt” SoilProfileCollection comes from
direct modification of the S4 object slot contents (not using standard
methods), which can result in omissions or reordering that bypasses
internal accounting methods.</p>
<p>Occasionally issues arise from illogical inputs (depths) or
collections that are missing data. The latter cases (standard methods
produce a corrupt SPC given some “degenerate” input data) are considered
“bugs” that should reported on the issue tracker: <a href="https://github.com/ncss-tech/aqp/issues" class="uri">https://github.com/ncss-tech/aqp/issues</a></p>
<p><code>checkSPC()</code> returns TRUE for a SoilProfileCollection that
contains all slots defined in the class prototype.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">checkSPC</span>(sp4)</span></code></pre></div>
<p><code>spc_in_sync()</code> is used as the validity method for the
SoilProfileCollection, it determines if some reordering of the horizon
data relative to the unique profile ID / site order has occurred.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">spc_in_sync</span>(sp4)</span></code></pre></div>
<pre><code>#&gt;   nSites relativeOrder valid
#&gt; 1   TRUE          TRUE  TRUE</code></pre>
<p><code>rebuildSPC()</code> is used to re-construct all the required
slots of a SoilProfileCollection, given a source, possibly corrupt,
object. This function fixes major issues related to the internal
ordering of data in slots, as well as missing slots or metadata.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">rebuildSPC</span>(sp4)</span></code></pre></div>
<p><code>checkHzDepthLogic()</code> has the ability to perform logical
tests on whole profiles or individual horizons. Four different tests are
performed related to four common errors in horizon depths:</p>
<ul>
<li><p>bottom depth shallower than top depth</p></li>
<li><p>equal top and bottom depth</p></li>
<li><p>missing (<code>NA</code>) top or bottom depth</p></li>
<li><p>gap or overlap between adjacent horizons</p></li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">checkHzDepthLogic</span>(sp4)</span></code></pre></div>
<pre><code>#&gt;                id valid depthLogic sameDepth missingDepth overlapOrGap
#&gt; 1          colusa  TRUE      FALSE     FALSE        FALSE        FALSE
#&gt; 2           glenn  TRUE      FALSE     FALSE        FALSE        FALSE
#&gt; 3           kings  TRUE      FALSE     FALSE        FALSE        FALSE
#&gt; 4        mariposa  TRUE      FALSE     FALSE        FALSE        FALSE
#&gt; 5       mendocino  TRUE      FALSE     FALSE        FALSE        FALSE
#&gt; 6            napa  TRUE      FALSE     FALSE        FALSE        FALSE
#&gt; 7      san benito  TRUE      FALSE     FALSE        FALSE        FALSE
#&gt; 8          shasta  TRUE      FALSE     FALSE        FALSE        FALSE
#&gt; 9  shasta-trinity  TRUE      FALSE     FALSE        FALSE        FALSE
#&gt; 10         tehama  TRUE      FALSE     FALSE        FALSE        FALSE</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="fu">checkHzDepthLogic</span>(sp4, <span class="at">byhz =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>#&gt;                id top bottom valid hzID depthLogic sameDepth missingDepth overlapOrGap
#&gt; 1          colusa   0      3  TRUE    1      FALSE     FALSE        FALSE           NA
#&gt; 2          colusa   3      8  TRUE    2      FALSE     FALSE        FALSE           NA
#&gt; 3          colusa   8     30  TRUE    3      FALSE     FALSE        FALSE           NA
#&gt; 4          colusa  30     42  TRUE    4      FALSE     FALSE        FALSE           NA
#&gt; 5           glenn   0      9  TRUE    5      FALSE     FALSE        FALSE           NA
#&gt; 6           glenn   9     34  TRUE    6      FALSE     FALSE        FALSE           NA
#&gt; 7           kings   0      4  TRUE    7      FALSE     FALSE        FALSE           NA
#&gt; 8           kings   4     13  TRUE    8      FALSE     FALSE        FALSE           NA
#&gt; 9           kings  13     40  TRUE    9      FALSE     FALSE        FALSE           NA
#&gt; 10       mariposa   0      3  TRUE   10      FALSE     FALSE        FALSE           NA
#&gt; 11       mariposa   3     14  TRUE   11      FALSE     FALSE        FALSE           NA
#&gt; 12       mariposa  14     34  TRUE   12      FALSE     FALSE        FALSE           NA
#&gt; 13       mariposa  34     49  TRUE   13      FALSE     FALSE        FALSE           NA
#&gt; 14      mendocino   0      2  TRUE   14      FALSE     FALSE        FALSE           NA
#&gt; 15      mendocino   2      8  TRUE   15      FALSE     FALSE        FALSE           NA
#&gt; 16      mendocino   8     30  TRUE   16      FALSE     FALSE        FALSE           NA
#&gt; 17           napa   0      6  TRUE   17      FALSE     FALSE        FALSE           NA
#&gt; 18           napa   6     20  TRUE   18      FALSE     FALSE        FALSE           NA
#&gt; 19     san benito   0      8  TRUE   19      FALSE     FALSE        FALSE           NA
#&gt; 20     san benito   8     20  TRUE   20      FALSE     FALSE        FALSE           NA
#&gt; 21         shasta   0      3  TRUE   21      FALSE     FALSE        FALSE           NA
#&gt; 22         shasta   3     40  TRUE   22      FALSE     FALSE        FALSE           NA
#&gt; 23 shasta-trinity   0      2  TRUE   23      FALSE     FALSE        FALSE           NA
#&gt; 24 shasta-trinity   2      5  TRUE   24      FALSE     FALSE        FALSE           NA
#&gt; 25 shasta-trinity   5     12  TRUE   25      FALSE     FALSE        FALSE           NA
#&gt; 26 shasta-trinity  12     23  TRUE   26      FALSE     FALSE        FALSE           NA
#&gt; 27 shasta-trinity  23     40  TRUE   27      FALSE     FALSE        FALSE           NA
#&gt; 28         tehama   0      3  TRUE   28      FALSE     FALSE        FALSE           NA
#&gt; 29         tehama   3      7  TRUE   29      FALSE     FALSE        FALSE           NA
#&gt; 30         tehama   7     16  TRUE   30      FALSE     FALSE        FALSE           NA</code></pre>
</div>
<div id="coercion" class="section level1">
<h1>Coercion</h1>
<p>SoilProfileCollection objects can be coerced to
<code>data.frame</code>, <code>list</code> and
<code>SpatialPointsDataFrame</code> (when spatial slot has been set
up):</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># check our work by viewing the internal structure</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="fu">str</span>(sp4)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="co"># create a data.frame from horizon+site data</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="fu">as</span>(sp4, <span class="st">&#39;data.frame&#39;</span>) </span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a><span class="co"># or, equivalently:</span></span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a><span class="fu">as.data.frame</span>(sp4)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a><span class="co"># convert SoilProfileCollection to a named list containing all slots</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a><span class="fu">as</span>(sp4, <span class="st">&#39;list&#39;</span>)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a><span class="co"># extraction of site + spatial data as SpatialPointsDataFrame</span></span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a><span class="fu">as</span>(sp4, <span class="st">&#39;SpatialPointsDataFrame&#39;</span>)</span></code></pre></div>
</div>
<div id="subsetting-soilprofilecollection-objects" class="section level1">
<h1>Subsetting SoilProfileCollection Objects</h1>
<p><code>SoilProfileCollection</code> objects can be subset using the
familiar <code>[</code>-style notation used by matrix and
<code>data.frame</code> objects, such that: <code>spc[i, j]</code> will
return profiles identified by the integer vector <code>i</code>, and
horizons identified by the integer vector <code>j</code>.</p>
<p>Omitting either index will result in all profiles (<code>i</code>
omitted) or all horizons (<code>j</code> omitted).</p>
<p>Typically, site-level attributes will be used as the subsetting
criteria. Functions that return an index to matches (such as
<code>grep()</code> or <code>which()</code>) provide the link between
attributes and an index to matching profiles.</p>
<div id="profiles" class="section level2">
<h2>Profiles</h2>
<p>Using the <em>i</em> index, select one or more profiles by numeric
index. An index greater than the number of profiles will return an empty
<code>SoilProfileCollection</code> object.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># explicit string matching</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(sp4<span class="sc">$</span>group <span class="sc">==</span> <span class="st">&#39;A&#39;</span>)</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a><span class="co"># numerical expressions</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(sp4<span class="sc">$</span>elevation <span class="sc">&lt;</span> <span class="dv">1000</span>)</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="co"># regular expression, matches any profile ID containing &#39;shasta&#39;</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">&#39;shasta&#39;</span>, <span class="fu">profile_id</span>(sp4), <span class="at">ignore.case =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a><span class="co"># perform subset based on index</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>sp4[idx, ]</span></code></pre></div>
<p>In an interactive session, it is often simpler to use
<code>subset()</code> directly:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="fu">subset</span>(sp4, group <span class="sc">==</span> <span class="st">&#39;A&#39;</span>)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="fu">subset</span>(sp4, elevation <span class="sc">&lt;</span> <span class="dv">1000</span>)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a><span class="fu">subset</span>(sp4, <span class="fu">grepl</span>(<span class="st">&#39;shasta&#39;</span>, id, <span class="at">ignore.case =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
</div>
<div id="horizons-by-index" class="section level2">
<h2>Horizons by Index</h2>
<p>Using the <em>j</em> index, select the 2nd horizon from each profile
in the collection. Use with caution, asking for a horizon beyond the
length of any profile in the collection will result in an error.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>sp4[, <span class="dv">2</span>]</span></code></pre></div>
</div>
<div id="horizons-by-keyword" class="section level2">
<h2>Horizons by Keyword</h2>
<p>Using the <em>k</em> index, select the <code>.FIRST</code> first or
<code>.LAST</code> horizons (by profile) within a collection. Note that
<code>.FIRST</code> and <code>.LAST</code> are special keywords used by
the <code>SoilProfileCollection</code> subset methods.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>sp4[, , .FIRST]</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>sp4[, , .LAST]</span></code></pre></div>
</div>
</div>
<div id="splitting-duplication-and-selection-of-unique-profiles" class="section level1">
<h1>Splitting, Duplication, and Selection of Unique Profiles</h1>
<p><code>SoilProfileCollection</code> objects are combined by passing a
list of objects to the <code>combine()</code> function.</p>
<p>Ideally all objects share the same internal structure, profile ID,
horizon ID, depth units, and other parameters of a
<code>SoilProfileCollection</code>. Manually subset the example data
into 3 pieces, compile into a list, and then <code>combine</code> back
together.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># subset data into chunks</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> sp4[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, ]</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> sp4[<span class="dv">4</span>, ]</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>s3 <span class="ot">&lt;-</span> sp4[<span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">9</span>), ]</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a><span class="co"># combine subsets</span></span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">combine</span>(<span class="fu">list</span>(s1, s2, s3))</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a><span class="co"># double-check result</span></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a><span class="fu">plotSPC</span>(s)</span></code></pre></div>
<p>It is possible to combine <code>SoilProfileCollection</code> objects
with different internal structure. The final object will contain the all
site and horizon columns from the inputs, possibly creating sparse
tables. IDs and horizon depth names are taken from the first object.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co"># sample data as data.frame objects</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="fu">data</span>(sp1)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="fu">data</span>(sp3)</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a><span class="co"># rename IDs horizon top / bottom columns</span></span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a>sp3<span class="sc">$</span>newid <span class="ot">&lt;-</span> sp3<span class="sc">$</span>id</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>sp3<span class="sc">$</span>hztop <span class="ot">&lt;-</span> sp3<span class="sc">$</span>top</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>sp3<span class="sc">$</span>hzbottom <span class="ot">&lt;-</span> sp3<span class="sc">$</span>bottom</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a><span class="co"># remove originals</span></span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>sp3<span class="sc">$</span>id <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>sp3<span class="sc">$</span>top <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>sp3<span class="sc">$</span>bottom <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a><span class="co"># promote to SoilProfileCollection</span></span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a><span class="fu">depths</span>(sp1) <span class="ot">&lt;-</span> id <span class="sc">~</span> top <span class="sc">+</span> bottom</span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a><span class="fu">depths</span>(sp3) <span class="ot">&lt;-</span> newid <span class="sc">~</span> hztop <span class="sc">+</span> hzbottom</span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a><span class="co"># label each group via site-level attribute</span></span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a><span class="fu">site</span>(sp1)<span class="sc">$</span>g <span class="ot">&lt;-</span> <span class="st">&#39;sp1&#39;</span></span>
<span id="cb45-21"><a href="#cb45-21" tabindex="-1"></a><span class="fu">site</span>(sp3)<span class="sc">$</span>g <span class="ot">&lt;-</span> <span class="st">&#39;sp3&#39;</span></span>
<span id="cb45-22"><a href="#cb45-22" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" tabindex="-1"></a><span class="co"># combine</span></span>
<span id="cb45-24"><a href="#cb45-24" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">combine</span>(<span class="fu">list</span>(sp1, sp3))</span>
<span id="cb45-25"><a href="#cb45-25" tabindex="-1"></a></span>
<span id="cb45-26"><a href="#cb45-26" tabindex="-1"></a><span class="co"># make grouping variable into a factor for groupedProfilePlot</span></span>
<span id="cb45-27"><a href="#cb45-27" tabindex="-1"></a>x<span class="sc">$</span>g <span class="ot">&lt;-</span> <span class="fu">factor</span>(x<span class="sc">$</span>g)</span>
<span id="cb45-28"><a href="#cb45-28" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" tabindex="-1"></a><span class="co"># check results</span></span>
<span id="cb45-30"><a href="#cb45-30" tabindex="-1"></a><span class="fu">str</span>(x)</span>
<span id="cb45-31"><a href="#cb45-31" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" tabindex="-1"></a><span class="co"># graphical check</span></span>
<span id="cb45-33"><a href="#cb45-33" tabindex="-1"></a><span class="co"># convert character horizon IDs into numeric</span></span>
<span id="cb45-34"><a href="#cb45-34" tabindex="-1"></a>x<span class="sc">$</span>.horizon_ids_numeric <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">hzID</span>(x))</span>
<span id="cb45-35"><a href="#cb45-35" tabindex="-1"></a></span>
<span id="cb45-36"><a href="#cb45-36" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb45-37"><a href="#cb45-37" tabindex="-1"></a><span class="fu">plotSPC</span>(x, <span class="at">color=</span><span class="st">&#39;.horizon_ids_numeric&#39;</span>, <span class="at">col.label =</span> <span class="st">&#39;Horizon ID&#39;</span>)</span>
<span id="cb45-38"><a href="#cb45-38" tabindex="-1"></a><span class="fu">groupedProfilePlot</span>(x, <span class="st">&#39;g&#39;</span>, <span class="at">color=</span><span class="st">&#39;.horizon_ids_numeric&#39;</span>, <span class="at">col.label =</span> <span class="st">&#39;Horizon ID&#39;</span>, <span class="at">group.name.offset =</span> <span class="sc">-</span><span class="dv">15</span>)</span></code></pre></div>
<div id="splitting" class="section level2">
<h2>Splitting</h2>
<p>The inverse of <code>combine()</code> is <code>split()</code>:
subsets of the <code>SoilProfileCollection</code> are split into list
elements, each containing a new <code>SoilProfileCollection</code>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># continuing from above</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a><span class="co"># split subsets of x into a list of SoilProfileCollection objects using site-level attribute &#39;g&#39;</span></span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">split</span>(x, <span class="st">&#39;g&#39;</span>)</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a><span class="fu">str</span>(res, <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="duplication" class="section level2">
<h2>Duplication</h2>
<p>Duplicate the first profile in <code>sp4</code> (Colusa) 8 times,
resulting in a new <code>SoilProfileCollection</code> object containing
unique profile IDs.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">duplicate</span>(sp4[<span class="dv">1</span>, ], <span class="at">times =</span> <span class="dv">8</span>)</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a><span class="fu">plotSPC</span>(d, <span class="at">color =</span> <span class="st">&#39;ex_Ca_to_Mg&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACACAMAAADTa0c4AAAAh1BMVEUAAABcu49cu6deTopeTqFmkLZmkNuQZmaQkGaQkJCQkLaQkNuQtraQttuQtv+Q2/+eADieAEG2Zma2kDq2kGa2kJC2kLa2tpC2tra2ttu2tv+229u22//bkJDbtmbbtpDbtrbb25Db27bb29vb/9vb///9uFr9uGn/25D/27b/29v//9v////FJ/ifAAAACXBIWXMAAATrAAAE6wHYKlsNAAACoElEQVR4nO3cYVObQBAG4GttNSFCrU3C0lChaGoN/v/f15H64ciw6V6Y3mZu3/3AOL7ZzfF8iHO5QfdqvJz2ArQLANoL0C4AaC9AuwCgvQDtAoD2ArQLANoL0K4LBOj3ZzQdzml6qxMATdHkS6o29UPRl9mPmklWzYprWv1ccclDwTatuXfKbvim3wXX9M1fXghAv6HNcrn4vL5dXLeL/KXmkvsvXNNtmXPJ+vqMpkXONeXtnn0nrykIwEgB4FQ2KmGk1SSadzz8XwBfvXLCSKlJNm/4safqtd0R1WYB2qqnR+q+WwU4ukkASAGago34JFqTbN4sANrup6M7xyURm2TzQgHS+zMYCPDslRNGSk2yeQAAAACMAwyfiKNvXIwBDNeylu4FjsYc2IhPYjXJ5oXuBUZjmnxL2XTEJ9GaZPNmfQbQxvuyyo9+OS6J2CSbhw9BAAAgCMD8ZuijV04YKTXJ5gEAAAAwDhB4MJIewHBtdt7RiEWAl523HbIIMJ4PAAAAAAAAAAAAAAAAEwDvmyHvbMgYwHBtau9syCIANkOjlwIAAAAAAAAAIAA48NEFNMnmzQLYUtbUU9EHxyURm2TzZgFQ6T04NV4Wl0Rsks3Dwchw7cj4wQg9YS9w8lfa9wIAAAAAAAAAAAAAAID/AICDkbfqKuMHI9gMjV4KAAAAAAAAAAAAADAFkN5jc4EHI5+8csJIqUk2730vIH5iJE2AviXpXiBNgKObBAAAAAAAAAAAAAAAgAmAwIOR9ACGayd+YiRNgHM3Qwc+uoAm2bxZnwFbyrpqKrpyXBKxSTZvFgCVOe2noivHJRGbZPPwVwAAAAAAAAAAAMMA1k+G/pb8f4mlCdC3ldmToambBMCJLLnj8UAAEwUA7QVol3mAP02ixByL/f4PAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
</div>
<div id="selecting-unique-profiles" class="section level2">
<h2>Selecting Unique Profiles</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co"># an example soil profile  </span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>  <span class="at">id =</span> <span class="st">&#39;A&#39;</span>,</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;E&#39;</span>, <span class="st">&#39;Bhs&#39;</span>, <span class="st">&#39;Bt1&#39;</span>, <span class="st">&#39;Bt2&#39;</span>, <span class="st">&#39;BC&#39;</span>, <span class="st">&#39;C&#39;</span>),</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>  <span class="at">top =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">100</span>),</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>  <span class="at">bottom =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">125</span>),</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">5</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">10</span>, <span class="dv">2</span>, <span class="dv">12</span>)</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>)</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a><span class="co"># init SPC</span></span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a><span class="fu">depths</span>(x) <span class="ot">&lt;-</span> id <span class="sc">~</span> top <span class="sc">+</span> bottom</span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a><span class="fu">hzdesgnname</span>(x) <span class="ot">&lt;-</span> <span class="st">&#39;name&#39;</span></span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a><span class="co"># horizon depth variability for simulation</span></span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a><span class="fu">horizons</span>(x)<span class="sc">$</span>.sd <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a><span class="co"># duplicate several times</span></span>
<span id="cb48-18"><a href="#cb48-18" tabindex="-1"></a>x.dupes <span class="ot">&lt;-</span> <span class="fu">duplicate</span>(x, <span class="at">times =</span> <span class="dv">5</span>)</span>
<span id="cb48-19"><a href="#cb48-19" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" tabindex="-1"></a><span class="co"># simulate some new profiles based on example</span></span>
<span id="cb48-21"><a href="#cb48-21" tabindex="-1"></a><span class="co"># 2cm constant standard deviation of transition between horizons assumed</span></span>
<span id="cb48-22"><a href="#cb48-22" tabindex="-1"></a>x.sim <span class="ot">&lt;-</span> <span class="fu">perturb</span>(x, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">thickness.attr =</span> <span class="st">&#39;.sd&#39;</span>)</span>
<span id="cb48-23"><a href="#cb48-23" tabindex="-1"></a></span>
<span id="cb48-24"><a href="#cb48-24" tabindex="-1"></a><span class="co"># graphical check</span></span>
<span id="cb48-25"><a href="#cb48-25" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>))</span>
<span id="cb48-26"><a href="#cb48-26" tabindex="-1"></a></span>
<span id="cb48-27"><a href="#cb48-27" tabindex="-1"></a><span class="co"># inspect unique results</span></span>
<span id="cb48-28"><a href="#cb48-28" tabindex="-1"></a><span class="fu">plotSPC</span>(<span class="fu">unique</span>(x.dupes, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&#39;top&#39;</span>, <span class="st">&#39;bottom&#39;</span>)),</span>
<span id="cb48-29"><a href="#cb48-29" tabindex="-1"></a>        <span class="at">name.style =</span> <span class="st">&#39;center-center&#39;</span>,</span>
<span id="cb48-30"><a href="#cb48-30" tabindex="-1"></a>        <span class="at">width =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACACAMAAADTa0c4AAAAilBMVEUAAABmZpBmkNuIiKyIrKyIrM+IrPKQkGaQkLaQtraQttusiIisiKysrIisrKysrM+sz/K2Zma2tpC2tra2ttu2tv+229u22//PrIjPrKzPz6zPz8/Pz/LP8vLbkJDbtpDbtrbb27bb29vb/9vb///yz6zyz8/y8s/y8vL/tmb/27b/29v//9v////VJvByAAAACXBIWXMAAATrAAAE6wHYKlsNAAACHklEQVR4nO3cW08CMRCGYTyfoCBFFjwBiuyKy///eyoxXtGBhdI2nfe74GrClCfN0pQJrZXytGIvIHYAiL2A2AEg9gJiB4DYC4gdAGIvIHYAiL2A2AEgXKvP07p//VqEa7hTwgHU9yc3V7dLvQCJBgD/77h3jrCSHYp8d121qj3jH+D3pbaD1XRorevZkz/AdFDbNzt7kIr8tk0LwEtRs7YAuDO61A1QmvaLagA52QCkcw7wVtSsrfodAAAAALiyeNYNULaflAMY5TtATjYAHIS07wAAAHBkERrg77FSz6Ui313dAGXb3PXG7i/CI+2A2aBfCNeiIQFM57w76oUGsO/itSjPAN9dOQewAwAAAIDNCX4Q8lbUrK3rA/4chM6EY4ACANO5+NAMsC3ZAHAQ0r4DAADAEc4B5uyxqxng5xxgmBBRAJDOOWD9luKVqIYd0B+Ks6LZA9RTy6XowUXN2gIAAAAAAAAAAAAAAAAAAAAAAAAAAPCfRVUFvRZfX4p+zVOZFP39ZaS7cAscaQcsi1QmRavSmPNxcIApk6KHFzVrCwAAAAAAAAAAAAAAAAAAAAAAAAAAgDaAxEZltxX57prcDpgMrRWGZfMHWA7FYdn8AXwUNWsLAAAAAAAAAJsjjAdoACil8QANAJURxgNUAIgBwPtKvBU1awsAAAAAAIBmgAQvRYVhWf8AqWVSiH+rmj/AshD/VjV/gC1RD/ANRCJ77JsysvMAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># &quot;uniqueness&quot; is a function of variables selected to consider</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">plotSPC</span>(<span class="fu">unique</span>(x.sim, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&#39;top&#39;</span>, <span class="st">&#39;bottom&#39;</span>)),</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>        <span class="at">name.style =</span> <span class="st">&#39;center-center&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACACAMAAADTa0c4AAAAnFBMVEUAAABmZpBmkNuIiKyIrKyIrM+IrPKQkGaQkLaQkNuQtraQttuQtv+Q2/+siIisiKysrIisrKysrM+sz/K2Zma2kGa2tpC2tra2ttu2tv+229u22//PrIjPrKzPz6zPz8/Pz/LP8vLbkJDbtmbbtpDbtrbb25Db27bb29vb/9vb///yz6zyz8/y8s/y8vL/tmb/27b/29v//9v///94G/JmAAAACXBIWXMAAATrAAAE6wHYKlsNAAADyklEQVR4nO2abVfTQBCFEfEFUEsKNLUBodqKYqs1/f//zRo4JE02O3eT3d6knfuBc9Bh9s6z0zmbTY/WB64jtgG2FADbAFsKgG2ALQXANsCWAmAbYEsBsA2wpQDYBthSAGwDbCkAtgG2FADbAFsKgG2ALQXANsCWAmAbYEsBsA2wpQDYBjwrfXT8A1cAf47T0fuvCRJ2OjuFwr5LYVnUtw9QsmvRWkmOANKrV2fvzlfSKk9hVx+RsLPRORJ1fewlWUX79hFwlgJwCDUIiwLDQq5pTr92A/C7IpOZahQYZgTga83s1zQer+eTOE7K/3EwAObjNP4RP3zuEoCbtwiAPApMZgRgrEqoOoSZYtgyGkxlAIUoYzJgBtRWJVQtLANVhnpuvaal63x2gNDbjT2HnwHGqoSqQ5jZClvcIwDyKDBZSACgGQEA+BF4SrAc3CFrWsI8AgDNgJyWEdIBhaj+DEGQk7VP9n8ILiQA2JrVZBUAzyYq9wXcIbgcRJ8ub+8lALbKapKZO+BhPEpKh2FnAJgZ1HN0cTK8uRQAWCvLotAZEP+sHIZdAchm5N2o82xas3MzYGvPwK0FGyXsDKitSqi6GIrthsumbRrltQ2T6wzIk3X/JAh+BMTK6pIFA+B1CEqYujgDxN2Q27HguV8zIKssunjzq2U75p7/c/oyFAHgM+AlGXEIyrtR8LzBGYkXItbK6pyRh2Ajz3VrbmGi3weIW9t4boUdgtnfGd4cNhmC9q2VzdSE7eBGaDSpXIw3GYJt25EGIJ3HrZ4FfLUjDYCxKqHqEGbwZApAASgABaAA9hvA5mAJvBx1T9YXAJuD5XAx9QSgmIwPwLIbRc9RdHIrA3BPZn4W+Pu4s/cCtt3Ak+XPlq7JzB2wStq/F0ABWHbDHYB7MjOAefv3Amg7gpwwAA2ShZsBHtoRr6yTANq3I15ZFwF4MIMnUwAKQAHsLQCHa/FGyXgA/F6Le+uAvn5b3Nt7geznbHMKLl2Mdx2ArzWfnwUmlYvxwwJgWkGouhiq7wU8mdkOsz1Z9RvAFAlbWp+s8mxQMkvY7gEUKrN6jmxPVi+3C1gySxihA/LKPMwAMFl9mFcAYDtinDAAzskCAkB7W/Ds9Si8UwDuvW3cW7c1OwXAfWtbAMDOHnJY/g+li3HvADqtWVL5wrz3k2CntUoqX5jvWwnepQDYBthSAGwDbCkAtgG2FADbAFsKgG2ALQXANsCWAmAbYEsBsA2wpQDYBthSAGwDbCkAtgG2FADbAFsKgG2ALQXANsCWAmAbYEsBsA2w9Q/QouUuw/QeLQAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">plotSPC</span>(<span class="fu">unique</span>(x.sim, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&#39;name&#39;</span>)),</span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>        <span class="at">name.style =</span> <span class="st">&#39;center-center&#39;</span>,</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>        <span class="at">width =</span> <span class="fl">0.15</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACACAMAAADTa0c4AAAAilBMVEUAAABmZpBmkNuIiKyIrKyIrM+IrPKQkGaQkLaQtraQttusiIisiKysrIisrKysrM+sz/K2Zma2tpC2tra2ttu2tv+229u22//PrIjPrKzPz6zPz8/Pz/LP8vLbkJDbtpDbtrbb27bb29vb/9vb///yz6zyz8/y8s/y8vL/tmb/27b/29v//9v////VJvByAAAACXBIWXMAAATrAAAE6wHYKlsNAAACRUlEQVR4nO2a2XKCQBBFs5hd0YgRzaYmRg3B//+9KD4JBSmogTOx73nwpavo6ylsZwbOtsY5owPQSAAdgEYC6AA0EkAHoJEAOgCNBNABaCSADkAjAXQAGgmgA9BIAB2ARgLoADQSQAegkQA6AI0E0AFoJIAOQAMJ+L5IhrfvEdP8CEZA8nh+d3Mf2xXgERLQ7NVr00CSgoLrTsdX39TEvYD9RxKOtvNxGEbZQmP4JmA+SsKPcPGULTSGZwIqFdy0LfmOk2sLAvwZgpULbtrqJyABhaxebQtYd18sCNAQrEljS+FkmS247nR8dX8EpJ+L0TDKLIYpAStEQPiZWwxDAtbd4GEwLf4fOPkZsA56nf5kcPoC9C9Qk9MXwAzBKgU3bYu+4G4IXpaMAAMCgt7VlwUBGoI1OX0BrQ/B9KbK7QTQIfjcb/0OGI5zB+PgEAze2haQzMO29wIagjWRAOdJKhfctJUACZAACZAACfBBQLq2+lkafy4QR948F2AEzL15LpDuh1vfDFUquGlb+A13++H+qtiAAQFB0JlaFvAHEuA8SeWCm7YSIAES4IkAvS2+Z7ZbBWcOxm0JiMe5g3FbAqoU3LTVcwHrd4AESIAEFFJyHmJBwLrsPMSCgE1Qch5iQkApDe4FMgfjVgQcmEW5F+atrAQPxFHuhflmBfwDJIAOQCMBdAAaCaAD0EgAHYBGAugANBJAB6CRADoAjQTQAWgkgA5AIwF0ABoJoAPQSAAdgEYC6AA0EkAHoJEAOgCNBNABaH4BQW/HQQkOBfsAAAAASUVORK5CYII=" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="plotting-soilprofilecollection-objects" class="section level1">
<h1>Plotting SoilProfileCollection Objects</h1>
<p>The <code>plotSPC()</code> method for
<code>SoilProfileCollection</code> objects generates sketches of
profiles within the collection based on horizon boundaries, vertically
aligned to an integer sequence from 1 to the number of profiles.</p>
<p>Horizon names are automatically extracted from a horizon-level
attribute <code>name</code> (if present), or via an alternate attributed
given as an argument: <code>name=&#39;column.name&#39;</code>.</p>
<p>Horizon colors are automatically generated from the horizon-level
attribute <code>soil_color</code>, or any other attribute of
<strong>R</strong>-compatible color description given as an argument:
<code>color=&#39;column.name&#39;</code>. This function is highly customizable,
therefore, it is prudent to consult <code>help(plotSPC)</code> from time
to time. Soil colors in Munsell notation can be converted to
<strong>R</strong>-compatible colors via <code>munsell2rgb()</code>.</p>
<p>Many of the following examples make use of <code>par()</code> to set
graphical options such as <code>mar</code> (customized margins) and/or
<code>xpd = NA</code> (turn off clipping) to optimize display of
different numbers of profiles and various <code>plotSPC()</code>
arguments.</p>
<p>A detailed description of each argument to <code>plotSPC()</code>
(and many examples) can be found in the <a href="https://ncss-tech.github.io/AQP/aqp/sketches.html">Soil Profile
Sketches tutorial</a>.</p>
<div id="making-adjustments" class="section level2">
<h2>Making Adjustments</h2>
<p>The <code>explainPlotSPC()</code> function is helpful for adjusting
some of the more obscure arguments to <code>plotSPC()</code>.</p>
<p>A basic plot with debugging information overlaid:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="fu">explainPlotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Make sketches wider:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a><span class="fu">explainPlotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">width =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAACgCAMAAACbmkHeAAACKFBMVEUAAAAAAP8AJQAAOv8AZAA6AAA6JQA6Ov86Zv86gGY6gJA6m2Y6m7ZmOv9mXQBmZGZmZmZmZpBmZrZmZv9mgGZmkLZmkP9mmzpmm2Zmm5Bmm7ZmtWZmtZBmtbZmtdtmtttmtv9mz7Zmz9tmz/+QZmaQZpCQZraQZv+QkJCQkLaQkNuQkP+Qm2aQm5CQtWaQtZCQtbaQtduQtraQttuQtv+Qz5CQz9uQz/+Q2/+Q59uQ5/+fOgCfOmafOpCfZjqfZmafZrazAGazOmazZjqzZmazZpCzZrazkGazkJCzkLaztrazttuztv+2Zma2Zv+2dgC2kJC2kLa2kP+2mwC2mzq2m2a2tTq2tWa2tba2tpC2tra2ttu2tv+229u22/+255C257a259u25/+2/7a2/9u2///HZgDHZmbHZpDHkGbHkJDHkLbHkNvHtpDHttvHtv/H27bH29vH2//aZjraZmbakGbakLbatpDa25Da27ba29va2//a/7ba/9va///bkP/btTrbtWbbtmbbtpDbtrbbttvbtv/bz2bbz5Db27bb29vb2//b57bb59vb/7bb/9vb///tkDrtkGbttmbttpDt25Dt/7bt///y8s/y8vL/pQD/tmb/tpD/trb/tv//xDr/xGb/xLb/z2b/z5D/02b/05D/07b/09v/25D/27b/29v/2///4ZD/4bb/4dv/55D/57b/8ZD/8bb/8dv/8f///7b//9v///9tkSBKAAAACXBIWXMAAATrAAAE6wHYKlsNAAAKdUlEQVR4nO2di2PTRBzHi6JTxBdVmOIDhzKweyirMFEEpQgooqtUXLbVZ22ZCgqbbxmjs2ziY0x0OMdEEVy3dcxtbf49k7Trkub3y+WSy6NtvrAu+fV6ufvkHr/7JV18vCdN+ZwugNvlASLIA0SQB4ggDxBBHiCCnAaUPZb/4Yu/BOV6v/z4WNEy/rUzRcvLQUDZ+LHJ7s8/THR/0d19IB0//sfByf0HJru/jB87v/PX+Evx4/yk8EY28cIn8ePjX3026kwpHQTUc6rn6ImRZ79N9IY+TVwI7R45MXJCsIjmgyOhZ3btHB0R3oh/m/hg187fnj/hUCkdBHQ+tFuAsee53T2hb/bG9xzsOXUy9GLPqbw5dHTfy7zwxosn9+0e2fdyz56DDpXS6TEoJzSXpe3s3lEHS4IIAOSrepEAWXUyykUeIII8QARZAmjMWFlcKSsAjVU1oHTiFJTPeKjovI3JCI3vhZcGI6CrNwmnRswX4mAmspIozHuhcqcTX8C5FGUA0CiYUY/s+MstKNcD4rwAlpa/kABJnNwPps5+CBbkj2fB1CNHIRDpRPcv2l4nNaDsR2A+53cqAf13eVbc6g0hgEYhcy/MDTGPw6ceSQ0fMvtRL8EhtWqQ/ufaopFPuk9mAM0vzi9ey2QW+YUFPrM4szgv/eMlQPP//cW2oE7JBKDc1dmZhUxmZpafWcxkFjLzM8LrVbFnCYD+vPwv45I6JBZdLLcgvsi6VFVP82SNVZQjpAFoxYoVnqOIAJqub5UArVg2pTkwDJDcApjH+CkwdZobhszja0Azk9QD0dKIjVbqJQ6yXRhQOLVB/CUHlHzM97tcy4Ag85lNkDn5WAw03w2bmaTe3EKRWs4hx3XwA12cLwoC8g+XAhLaBAWg5GbIPCWcN6i0W0Cz2FTU5twrICA6M5/uAA+pADTQkeO+53ydEKCC5IDgNoECAtvbmU3wWVYBSgZF810PA6mn2mGcMHwgdTAptInkvURAEBMtQCoSUiX4NNiCEW7qNiFmIlVCKa5tOD9O6MKJwA8upVaqbSgKZRI0Dai0TUiV4M/crQ9Qvk2o2ruUyaUumAQyqsCASnFe9Enlo0ttAlB6MzRdSWbg+EKjgEggExAliRYew6nOG+uQcGozgITKUYzG/NR3YLHAUQUZjbFucAaZxRAS8GCDpDYDKIn0JXA0Tj+6huZ0wlUWCyS3FroBjDP9KJg3MIsFhzqw1KYAXerSUwltM3w6hW6KlRYkoa6yRB8e0rOPqyhvHUb7qRlAiKOoqkQyiAPC5iXVGDRFAb/QsBAXAnGZkX66lL+UKjdMBQgo7RRk5grTgal5qY3bInorcCY07Q05pKrnXfQVjijj0B7FPWk9gJItQjV0nmVt/1VdZa69JR3lVRe+6QFhnnRp6ou+whGXOdB60uqm8trW9hY6QMiUgg8IFP0USY0MTXi5SzmY6WLUZswJ1neWietMitWNSwEhZnzlaL5NaLQ3xo6ihYDwlaP5NkHX3kwCgpGz6Xl0eetPTTfnmQRkhgTi2dA4PEbMkMs8ZTcgXacT8Wy0HB4mZvWI1dLWwQiQMiZtsrRFz0aXmR2g0hHrou+1rdywcUATNUExZB9VB+0trISrzNJbeNA+HAjEBEABddDeTZWwHJD0muwSw/Y+jovK36hfK/wOAEF7N1XCHkDpLnGx4eOGlhcbvunbW1Oy0GN1A1Jvi10sWF95gHRMs+JqfqhDB6AJf7DyAOkwi6t5rlhzrRYUCLACZJXfbbGZAGg6dYtrW5DYDRwHFK6xGpDxhiV2A8cB9bXK993VguxpWNqAUp31t8fKDhDThqUNaPpcuOwAWbjUEK9rlACqv7HGtYO07UuNqHhdo2SpEY71VU0LIoVcoaUGn6r3V0sL0lBlzWL2ApoOVM0gbQxQX80tsv0KBKS8xszzK1fSAToUrfBBWnmNmR5QPmCmC5CVFySsvthhHJC8ixFi0lZekGgrRGfcNwZJXWzCH9QRtLfyggRXiM5gS1sWoRQtQBp32ktd7NBalwTt6cS4BQ1xQNA+1Sq4jX01a10StKcTY0Dcz4AnHY4dMjmLMR1f6WTHGEQxiyHmtkJ0xuqZBjCrHB6jeWsB6pMtxQwB4grRGecBEcJEGnlrAQrLephbxiBDgCzyg8JrzbYgpmY60cc1sIyQbXEnVbNheb9CAFHnrQEo1XlONo1ZD4gw59HJlllMIesBEdYUdLID0EQ0INu3HlBxTeEuQGjQng/XB9wU7sjLoVlsqAMI2k93ht0Uk9aohPWAwKWGZXd3GFuBOApIvc327g6l2ViEh052DNKW3d1BGI3LBlB4g3zfJWOQXtniB/W56tIznewA1Bc8J9v3AKm7mOU3UBmohJtmMfmlZxfcaa9RCYcATYv3B034O8GrGlbelqkVkrAfEH5VI+8o2n9Vg4kYj0FD0FcRJEcx7Lf9qgYTsQWUG+CApYZTtwEzkS0Bs1b518QrEJDyOwdYRsg2k+tixsxMpA+Q/DsHWEbINpPrYsbMeemdrhCzHdO8Uh4gJoDo3CMWDg9idikgRC4dg0yv5hWqWkB40F6pqgUkvQ5Bd9orpeseRatLq192eNJKke5R1PK4yh4QsE0HiFN4XNZNKRUyi3mAPEClO3y1z2LqbQ/Q0ieQbQ/Q0ieQ7RJAOoP2VpdWv+wD1Kfnqwikg1CtYZmI7osL2hktbyveyP9K+WmC9nmZnGnoMrHanC8W/PeDRKX8AYqgPd3xywdQbqDD3FLD2PE1F3SuAgRskwBR92Xo2EpA4oIuSv6UzTIIiM2xlYC49q0DpGsM9stFgBjnzkgeIII8QASZAmTNiptJ3szMHiCC2WDQnsnxywOQ9Ar+eRylqnoMovek2Ry7bAAB22RA85nZ+cy1mQUTx3YboOLDYucXiw+LvVn2xE86QFevZkTNGi+P2wCBD4u9Q1ZBzw+Sq/CwWMNdTHw+aH7YVz0otHxnMeChpz6ZiQLQmFLGiuU6QGOIigVWlL7k01a0IAvvDzJmNt6CSmPS1SPSGDQN32lfPfIRni+Wqvfng/al71eX2tGgffFOe750zLjh1Zukn4rUHXC9tJYasFZWlmgalR5ATteHudgDqgYzIg8QQR4ggqp4TtcnDxBBHiCCPEAEeYAI0gNorjEGma/U7gDN970L5tIPpr4Op0bMgw3wIbGSQOWea3wLzgWWPkDwFxojILccbB4ES8sPNoIkDj8Aps4+ARbk71vB1P1NEIi5xuazG8FsQOkBlH0SNJ9eBRbrSC0CCKR8BOaGmK/Apx5JDR8y++QRuCiwvDGIIA8QQS4HdOXtbfmNH50qgXOAck3b5hq2X29+cDD25g8N2+eatvFX3nlzWLRnG8T/15vfbrznqebmB4VkZ1f91LDdkWI6B+jwDmF6Xt3/dOPZ9Q8JG2dvfZfP3rmjv06wR2KR2likaUfk/cYjtU83Dtau/nvj67etohha2ck5QG/UPtKwbmPkvfuvr/q5YV1dpOkhPrJuo2ivO127WvgfiR1evzpS+959QrLTdf3r6xwppsvHIOflASLIA0SQB4ggDxBB/wOj7hC86BomsQAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>Move soil surface at 0cm “down” 5cm:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a><span class="fu">explainPlotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">y.offset =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Move soil surface at 0cm “up” 10cm; useful for sketches of shallow
profiles:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a><span class="fu">explainPlotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">y.offset =</span> <span class="sc">-</span><span class="dv">10</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAACgCAMAAACbmkHeAAACNFBMVEUAAAAAAP8AJQAAOv8AZAA6AAA6JQA6Ov86Zv86gGY6gJA6m2Y6m7ZmAABmJQBmOv9mXQBmZGZmZpBmZv9mgGZmkLZmkP9mmzpmm2Zmm5Bmm7ZmtWZmtZBmtbZmtdtmtv9mz7Zmz9tmz/+QQgCQZmaQZpCQZraQZv+QkLaQkP+Qm2aQm5CQtWaQtZCQtbaQtduQtraQttuQtv+Qz5CQz9uQz/+Q2/+Q59uQ5/+fOgCfOmafOpCfZjqfZmafZrazAGazOmazZjqzZmazZpCzZrazkGazkJCzkLaztrazttuztv+2XQC2Zma2Zv+2dgC2kJC2kLa2kP+2mwC2mzq2m2a2tTq2tWa2tba2tpC2tra2ttu2tv+229u22/+255C257a259u25/+2/7a2/9u2///HZgDHZmbHZpDHkGbHkJDHkLbHtpDHttvHtv/H27bH29vH2//aZjraZmbakGbakLbatpDa25Da27ba29va2//a/7ba/9va///bkP/btTrbtWbbtmbbtpDbtrbbtv/bz2bbz5Db27bb29vb2//b57bb59vb/7bb/9vb///tkDrtkGbttpDt25Dt/7bt///y8s/y8vL02Yj02az05az05c/05fL22Yj22az25az25c/25fL42az/pQD/tmb/tpD/tv//xDr/xGb/z2b/z5D/02b/05D/07b/25D/27b/29v/2///4ZD/4bb/4dv/55D/57b/8ZD/8bb/8dv/8f///7b//9v////jjFMQAAAACXBIWXMAAATrAAAE6wHYKlsNAAAJM0lEQVR4nO2dj18TZRzHh2EokVYUzkwNzJBfKaRImZSomZTGciEHkmlrSGEhVlaKNAZoJVIJ/iiLlqaE/Bogst0/191ubLft+9xzz91tz+32fF78uPvueJ7v897z877PDRvPpCgbbQfMLgYIIwYIIwYIIwYIIwYII9qAAh3SNx/5JSh49tznHRHLne/ouCaJIqCAu2Oi/evP2tq/aW8/MOk+/U/9xNsHJtrPuTuu7vrV/Y77ND8hvBBoe+sL9+k73351jY6XFAF1Xeg61Tn0+vm2s3Vftv1SVzvUOdQpWERz/VDda7t3XRsSXnCfb/t0967f3uyk5CVFQFfragUYe96o7ar7fq97T33X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" style="display: block; margin: auto;" /></p>
<p>Scale depths by 50%:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a><span class="fu">explainPlotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">scaling.factor =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>A graphical explanation of how profiles are re-arranged via
<code>plot.order</code> argument:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a><span class="fu">explainPlotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">plot.order =</span> <span class="fu">length</span>(sp4)<span class="sc">:</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Leave room for an additional 2 profile sketches:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a><span class="fu">explainPlotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">n =</span> <span class="fu">length</span>(sp4) <span class="sc">+</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div id="small-soilprofilecollections" class="section level3">
<h3>Small SoilProfileCollections</h3>
<p>Making quality figures with fewer than 5 soil profiles usually
requires more customization of the basic call to <code>plotSPC</code>.
In general, the following are a good starting point:</p>
<ul>
<li>shrink margins and disable clipping with <code>par</code></li>
<li>adjust output graphic device (e.g. <code>png()</code>) dimensions
and resolution</li>
<li>increase font size with <code>cex.names</code></li>
<li>adjust sketch width with <code>width</code>, typically within
0.15-0.35</li>
<li>move depth axis to the left using negative <code>line</code> values,
e.g. (<code>depth.axis = list(line = -2)</code>)</li>
</ul>
<p>Get some example data from the Official Series Descriptions:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">data</span>(osd)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> osd</span></code></pre></div>
<p>Using 5x6 inch output device:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="at">xpd =</span> <span class="cn">NA</span>)</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a><span class="fu">plotSPC</span>(x[<span class="dv">1</span>, ], <span class="at">cex.names =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAADACAMAAAC05ZhFAAAA7VBMVEUAAAAAADoAOmYAOpAAZrY6AAA6Ojo6OmY6OpA6ZmY6ZpA6ZrY6kLZmOgBmOjpmOmZmOpBmZjpmZpBmZrZmkGZmkJBmkLZmkNtmtpBmtrZmtv+Od06Od1uQOjqQZjqQZpCQkGaQkJCQkLaQtpCQtraQttuQtv+Q29uQ2/+WTCacczeicD+ukGi2ZgC2Zjq2Zma2ZpC2kDq2kGa2kJC2tpC2tra2ttu229u22/+2/9u2///ZpXHbkDrbkGbbkJDbtmbbtpDbtrbb25Db29vb2//b/7bb/9vb////tmb/tpD/27b/29v//7b//9v///9IlSyEAAAACXBIWXMAAATrAAAE6wHYKlsNAAAC3ElEQVR4nO3ca3PSQBQG4CiKl2KlCrREISaGEm9VCa1aQ0sNuo24+f8/xyTY8Uuz2SYr58z4vjOBYcgkzyQsC5wcrJR5LGpAVQBsGgCbBsCmAbBpAGyaukCRyjjeLNkjmUqR3a2PVwZpm9QEvmuJqHO0Uyx29tCOWt+75/fnu4FZXl3gr+5HO+rMdoplA2wPu+NAxoZ5dYGX1t07UedEFMsGOHzUGts/x7ZhXz2gHAVytJdZclx0q72fAe3L1rfd9m0mp3iLYQCMherZOkCrKvrbyW4XUzcTrvP3qrUp4HN1tIHFbSjOTjOlN/Yfz/e5AqUj0vdfnB8eR2ByMMjOs++xBZpY6abAC+W4ZAB0D5fhZ87A/tNjecIX+MxKk3svD/kC80ES6rwKKYF62/l/gabm4n8GfKsOgI2Brqc1ldAB9WY6QqCvMY0QA4lPMfu3mdfq8Ae6k3OdgUwHFKFL+2GhCug7PZ2BTDdICiDlKX6jDv0gARBAAAEEEEAAAQTw777jlaqWQwosvv8l05WqlkN/BBe9gaqWQw/MiA8VtRx64GLoLRW1HHqgiZUABBBAAAEEEEAAAWQFdCfXXSbGCChmezoXOtIBfadPW8ipBvY0LjzCIAEQQAABBBBAAAEEMI8UeZ2krFRCXyeRo2AxdWdlpRIGRzAJQnHWLyuVcAJeWyphAUwOBqVtLwyABlYCEEAAAQQQQAABvBGQfT/JK3UABJAc6E4kbctQFTBvGVpX//UMHZC8FFYNnHsaXfgYJHyB7Ke6r+oACCCAAAII4FaBeSGnvOeFFHhVyFH1vDA4gkmg6nlhAVT1vLAAqnpeGAANrAQggAACCCCA2wWS/3NZFVDn10taoOZ2yIA6v16SAnW3AyCAAAIIIIAAAggggAACCGDlvmPzHTmmgEUhZ/bpwwvTHTmGgH8iHdd0R46hy1KufKemO3LM5ujBk6XhjpytBsCmAbBp2AN/AwfHKgVnYHKjAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>Using 7x6 inch output device, slight adjustments to
<code>width</code> usually required:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co"># set margins and turn off clipping</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="at">xpd =</span> <span class="cn">NA</span>)</span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="fu">plotSPC</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, ], <span class="at">cex.names =</span> <span class="dv">1</span>, <span class="at">width =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Using 8x6 inch output device, slight adjustments to are usually
required:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">4</span>), <span class="at">xpd =</span> <span class="cn">NA</span>)</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a><span class="fu">plotSPC</span>(x, <span class="at">cex.names =</span> <span class="dv">1</span>, <span class="at">depth.axis =</span> <span class="fu">list</span>(<span class="at">line =</span> <span class="sc">-</span><span class="fl">0.1</span>), <span class="at">width =</span> <span class="fl">0.3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="horizon-depth-labeling" class="section level2">
<h2>Horizon Depth Labeling</h2>
<p>Horizon depths can be labeled for each profile as an alternative to a
single depth axis.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a><span class="fu">plotSPC</span>(</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  x,</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>  <span class="at">cex.names =</span> <span class="dv">1</span>,</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  <span class="at">name.style =</span> <span class="st">&#39;center-center&#39;</span>,</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  <span class="at">width =</span> <span class="fl">0.3</span>,</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  <span class="at">depth.axis =</span> <span class="cn">FALSE</span>,</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>  <span class="at">hz.depths =</span> <span class="cn">TRUE</span>,</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>  <span class="at">hz.depths.offset =</span> <span class="fl">0.08</span></span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>As of aqp version 1.41, it is possible to “fix” overlapping horizon
depth labels with the new <code>fixLabelCollisions</code> argument. This
approach to labeling depths works best when moving horizon designations
with the <code>name.style</code> argument. Note that setting
<code>fixLabelCollisions = TRUE</code> may incur a performance penalty
when plotting large <code>SoilProfileCollection</code> objects.</p>
<p>As of aqp version 2.0, <code>fixLabelCollisions</code> is set to
<code>TRUE</code> when setting <code>hz.depths = TRUE</code>.</p>
</div>
<div id="relative-horizontal-positioning" class="section level2">
<h2>Relative Horizontal Positioning</h2>
<p>Relative horizontal positioning via <code>relative.pos</code>
argument. Can be used with <code>plot.order</code> but be careful:
<code>relative.pos</code> must be specified in the <em>final</em>
ordering of profiles. See <code>?plotSPC</code> for details.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="fu">jitter</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sp4))</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a><span class="fu">explainPlotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">relative.pos =</span> pos)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Relative positioning works well when the vector of positions is close
to the default spacing along an integer sequence, but not when positions
are closer than the width of a profile sketch.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="fl">5.2</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a><span class="fu">explainPlotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">relative.pos =</span> pos)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The <code>fixOverlap()</code> function can be used to find a suitable
arrangement of profiles based on a compromise between the suggested
relative positions and minimization of overlap.</p>
<p>This is an iterative procedure, based on random perturbations of
overlapping profiles, therefore it is possible for the algorithm to stop
at a sub-optimal configuration. Results can be controlled using
<code>set.seed()</code>.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>new.pos <span class="ot">&lt;-</span> <span class="fu">fixOverlap</span>(pos)</span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a><span class="fu">explainPlotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">relative.pos =</span> new.pos)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>There are several parameters available for optimizing horizontal
position in the presence of overlap. See <code>?fixOverlap</code> for
details and further examples.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>new.pos <span class="ot">&lt;-</span> <span class="fu">fixOverlap</span>(pos, <span class="at">thresh =</span> <span class="fl">0.7</span>)</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a><span class="fu">explainPlotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">relative.pos =</span> new.pos)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" />
The <a href="http://ncss-tech.github.io/AQP/aqp/SPC-plotting-ideas.html">SPC
plotting ideas tutorial</a> contains several additional examples.</p>
</div>
<div id="thematic-sketches" class="section level2">
<h2>Thematic Sketches</h2>
<p>Horizon-level attributes can be symbolized with color, in this case
using the horizon-level attribute “clay”:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>))</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a><span class="fu">plotSPC</span>(sp4,</span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">&#39;name&#39;</span>,</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&#39;clay&#39;</span>,</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>        <span class="at">col.label =</span> <span class="st">&#39;Clay Content (%)&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Use a different set of colors:</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>)) </span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a><span class="fu">plotSPC</span>(</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>  sp4,</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&#39;name&#39;</span>,</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&#39;clay&#39;</span>,</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>  <span class="at">col.label =</span> <span class="st">&#39;Clay Content (%)&#39;</span></span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Categorical properties can also be used to make a thematic sketch.
Colors are interpolated when there are more classes than colors provided
by <code>col.palette</code>:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>))</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a><span class="fu">plotSPC</span>(</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a>  sp4,</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&#39;name&#39;</span>,</span>
<span id="cb69-5"><a href="#cb69-5" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&#39;name&#39;</span>,</span>
<span id="cb69-6"><a href="#cb69-6" tabindex="-1"></a>  <span class="at">col.label =</span> <span class="st">&#39;Original Horizon Name&#39;</span></span>
<span id="cb69-7"><a href="#cb69-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Try with <a href="http://ncss-tech.github.io/AQP/aqp/gen-hz-assignment.html">generalized
horizon labels</a>:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>)) </span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a><span class="co"># generalize horizon names into 3 groups</span></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>sp4<span class="sc">$</span>genhz <span class="ot">&lt;-</span> <span class="fu">generalize.hz</span>(sp4<span class="sc">$</span>name, <span class="at">new =</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;AB&#39;</span>, <span class="st">&#39;Bt&#39;</span>), <span class="at">pat =</span> <span class="fu">c</span>(<span class="st">&#39;A[0-9]?&#39;</span>, <span class="st">&#39;AB&#39;</span>, <span class="st">&#39;^Bt&#39;</span>))</span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a><span class="fu">plotSPC</span>(</span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>  sp4,</span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&#39;name&#39;</span>,</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&#39;genhz&#39;</span>,</span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>  <span class="at">col.label =</span> <span class="st">&#39;Generalized Horizon Name&#39;</span></span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Horizon-level attributes that represent a volume fraction
(e.g. coarse-fragment percentage) can be added to an existing figure.
See <code>?addVolumeFraction</code> for adding layers to an existing
plot based on these attributes.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>)) </span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a><span class="co"># convert coarse rock fragment proportion to percentage</span></span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>sp4<span class="sc">$</span>frag_pct <span class="ot">&lt;-</span> sp4<span class="sc">$</span>CF <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a><span class="co"># label horizons with fragment percent</span></span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a><span class="fu">plotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;frag_pct&#39;</span>, <span class="at">color =</span> <span class="st">&#39;frag_pct&#39;</span>)</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a><span class="co"># symbolize volume fraction data</span></span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a><span class="fu">addVolumeFraction</span>(sp4, <span class="at">colname =</span> <span class="st">&#39;frag_pct&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="depth-intervals" class="section level2">
<h2>Depth Intervals</h2>
<p>Annotation of depth-intervals can be accomplished using “brackets”.
Here we extract top/bottom depths associated with top and bottom depth A
horizons using the min/max variants of the <code>depthOf()</code>
function. See ?depthOf for more details.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># extract top/bottom depths associated with all A horizons</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>tops <span class="ot">&lt;-</span> <span class="fu">minDepthOf</span>(sp4, <span class="at">pattern =</span> <span class="st">&#39;^A&#39;</span>, <span class="at">hzdesgn =</span> <span class="st">&#39;name&#39;</span>, <span class="at">top =</span> <span class="cn">TRUE</span>)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>bottoms <span class="ot">&lt;-</span> <span class="fu">maxDepthOf</span>(sp4, <span class="at">pattern =</span> <span class="st">&#39;^A&#39;</span>, <span class="at">hzdesgn =</span> <span class="st">&#39;name&#39;</span>, <span class="at">top =</span> <span class="cn">FALSE</span>)</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>IDs <span class="ot">&lt;-</span> <span class="fu">profile_id</span>(sp4)</span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a><span class="co"># assemble data.frame</span></span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> IDs, <span class="at">top =</span> tops<span class="sc">$</span>top, <span class="at">bottom =</span> bottoms<span class="sc">$</span>bottom)</span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a><span class="co"># check</span></span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>#&gt;                id top bottom
#&gt; 1          colusa   0      8
#&gt; 2           glenn   0      9
#&gt; 3           kings   0      4
#&gt; 4        mariposa   0      3
#&gt; 5       mendocino   0      2
#&gt; 6            napa   0      6
#&gt; 7      san benito   0      8
#&gt; 8          shasta   0      3
#&gt; 9  shasta-trinity   0     12
#&gt; 10         tehama   0      3</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a><span class="fu">plotSPC</span>(sp4)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a><span class="co"># annotate A horizon depth interval with brackets</span></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a><span class="fu">addBracket</span>(a, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">offset =</span> <span class="sc">-</span><span class="fl">0.4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Add labels:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a><span class="fu">plotSPC</span>(sp4, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>)</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a><span class="co"># addBracket() looks for a column `label`; add a ID for each bracket</span></span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>a<span class="sc">$</span>label <span class="ot">&lt;-</span> <span class="fu">site</span>(sp4)<span class="sc">$</span>id</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a><span class="co"># note that depth brackets &quot;knows which profiles to use&quot; via profile ID</span></span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a><span class="fu">addBracket</span>(</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>  a,</span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&#39;red&#39;</span>,</span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>  <span class="at">label.cex =</span> <span class="fl">0.75</span>,</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a>  <span class="at">missing.bottom.depth =</span> <span class="dv">25</span>,</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a>  <span class="at">offset =</span> <span class="sc">-</span><span class="fl">0.4</span></span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>It is possible to arrange profile sketches by site-level grouping
variable:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)) </span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="fu">groupedProfilePlot</span>(sp4, <span class="at">groups =</span> <span class="st">&#39;group&#39;</span>)</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a><span class="fu">addBracket</span>(a, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">offset =</span> <span class="sc">-</span><span class="fl">0.4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>There need not be brackets for all profiles in a collection:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>a.sub <span class="ot">&lt;-</span> a[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,]</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a><span class="fu">groupedProfilePlot</span>(sp4, <span class="at">groups =</span> <span class="st">&#39;group&#39;</span>)</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a><span class="fu">addBracket</span>(a.sub, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">offset =</span> <span class="sc">-</span><span class="fl">0.4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>When bottom depths are missing an arrow is used:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>a<span class="sc">$</span>bottom <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a><span class="fu">groupedProfilePlot</span>(sp4, <span class="at">groups =</span> <span class="st">&#39;group&#39;</span>)</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a><span class="fu">addBracket</span>(a, <span class="at">col =</span> <span class="st">&#39;red&#39;</span>, <span class="at">offset =</span> <span class="sc">-</span><span class="fl">0.4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Manually define bottom depth:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a><span class="fu">groupedProfilePlot</span>(sp4, <span class="at">groups =</span> <span class="st">&#39;group&#39;</span>)</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a><span class="fu">addBracket</span>(</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>  a,</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&#39;red&#39;</span>,</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>  <span class="at">label.cex =</span> <span class="fl">0.75</span>,</span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>  <span class="at">missing.bottom.depth =</span> <span class="dv">25</span>,</span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>  <span class="at">offset =</span> <span class="sc">-</span><span class="fl">0.4</span></span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Further customization of brackets:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a><span class="fu">plotSPC</span>(sp4, <span class="at">max.depth =</span> <span class="dv">75</span>)</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a><span class="co"># copy root-restricting features</span></span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">restrictions</span>(sp4)</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a><span class="co"># add a label: restrictive feature &#39;kind&#39;</span></span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>a<span class="sc">$</span>label <span class="ot">&lt;-</span> a<span class="sc">$</span>kind</span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a><span class="co"># add restrictions using vertical bars</span></span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a><span class="fu">addBracket</span>(</span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>  a,</span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&#39;red&#39;</span>,</span>
<span id="cb80-14"><a href="#cb80-14" tabindex="-1"></a>  <span class="at">label.cex =</span> <span class="fl">0.75</span>,</span>
<span id="cb80-15"><a href="#cb80-15" tabindex="-1"></a>  <span class="at">tick.length =</span> <span class="dv">0</span>,</span>
<span id="cb80-16"><a href="#cb80-16" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">3</span>,</span>
<span id="cb80-17"><a href="#cb80-17" tabindex="-1"></a>  <span class="at">offset =</span> <span class="sc">-</span><span class="fl">0.4</span></span>
<span id="cb80-18"><a href="#cb80-18" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div id="notes" class="section level3">
<h3>Notes</h3>
<p>These functions (<code>addBracket()</code>,
<code>addDiagnosticBracket()</code>, and
<code>addVolumeFraction()</code>) will automatically compensate for
alternative sketch ordering or relative positioning of profiles.</p>
</div>
</div>
<div id="svg-output-for-use-in-page-layout-tools" class="section level2">
<h2>SVG Output for Use in Page Layout Tools</h2>
<p>Sketches for use in layout tools such as Adobe Illustrator or
Inkscape should be stored in a vector file format. SVG is compatible
with most software titles. WMF output is compatible with MS Office tools
and can be written with the <code>win.metafile()</code> function.</p>
<!-- including this example (uncommented) will require svglite added to Suggests -->
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="co"># library(svglite)</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="co"># svglite(filename = &#39;e:/temp/fig.svg&#39;, width = 7, height = 6, pointsize = 12)</span></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a><span class="co"># par(mar = c(0,2,0,4), xpd = NA)</span></span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a><span class="co"># plotSPC(x, cex.names=1, depth.axis = list(line = -0.2), width=0.3)</span></span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a><span class="co"># dev.off()</span></span></code></pre></div>
</div>
</div>
<div id="iterating-over-profiles-in-a-collection" class="section level1">
<h1>Iterating Over Profiles in a Collection</h1>
<p>The <code>profileApply()</code> function is an extension of the
familiar <em>apply()</em> family of functions extended to
<code>SoilProfileCollection</code> objects.</p>
<p>The function named in the <code>FUN</code> argument is evaluated once
for each profile in the collection, typically returning a single value
per profile. In this case, the ordering of the results would match the
ordering of values in the site level attribute table.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="co"># max() returns the depth of a soil profile</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>sp4<span class="sc">$</span>soil.depth <span class="ot">&lt;-</span> <span class="fu">profileApply</span>(sp4, <span class="at">FUN =</span> max)</span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a><span class="co"># max() with additional argument give max depth to non-missing &#39;clay&#39;</span></span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>sp4<span class="sc">$</span>soil.depth.clay <span class="ot">&lt;-</span> <span class="fu">profileApply</span>(sp4, <span class="at">FUN =</span> max, <span class="at">v =</span> <span class="st">&#39;clay&#39;</span>)</span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a><span class="co"># nrow() returns the number of horizons</span></span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>sp4<span class="sc">$</span>n.hz <span class="ot">&lt;-</span> <span class="fu">profileApply</span>(sp4, <span class="at">FUN =</span> nrow)</span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a></span>
<span id="cb82-10"><a href="#cb82-10" tabindex="-1"></a><span class="co"># compute the mean clay content by profile using an inline function</span></span>
<span id="cb82-11"><a href="#cb82-11" tabindex="-1"></a>sp4<span class="sc">$</span>mean.clay <span class="ot">&lt;-</span> <span class="fu">profileApply</span>(sp4, <span class="at">FUN =</span> <span class="cf">function</span>(i) <span class="fu">mean</span>(i<span class="sc">$</span>clay))</span>
<span id="cb82-12"><a href="#cb82-12" tabindex="-1"></a></span>
<span id="cb82-13"><a href="#cb82-13" tabindex="-1"></a><span class="co"># estimate soil depth based on horizon designation</span></span>
<span id="cb82-14"><a href="#cb82-14" tabindex="-1"></a>sp4<span class="sc">$</span>soil.depth <span class="ot">&lt;-</span> <span class="fu">profileApply</span>(sp4, estimateSoilDepth, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>)</span></code></pre></div>
<p>When <code>FUN</code> returns a vector of the same length as the
number of horizons in a profile, <code>profileApply()</code> can be used
to create new horizon-level attributes. For example, the change in clay
content by horizon depth (<code>delta.clay</code>, below) could be
calculated as:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="co"># save as horizon-level attribute</span></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>sp4<span class="sc">$</span>delta.clay <span class="ot">&lt;-</span> <span class="fu">profileApply</span>(sp4, <span class="at">FUN =</span> <span class="cf">function</span>(i) <span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(i<span class="sc">$</span>clay)))</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a><span class="co"># check results:</span></span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a><span class="fu">horizons</span>(sp4)[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="fu">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;top&#39;</span>, <span class="st">&#39;bottom&#39;</span>, <span class="st">&#39;clay&#39;</span>, <span class="st">&#39;delta.clay&#39;</span>)]</span></code></pre></div>
<pre><code>#&gt;       id top bottom clay delta.clay
#&gt; 1 colusa   0      3   21         NA
#&gt; 2 colusa   3      8   27          6
#&gt; 3 colusa   8     30   32          5
#&gt; 4 colusa  30     42   55         23
#&gt; 5  glenn   0      9   25         NA
#&gt; 6  glenn   9     34   34          9</code></pre>
<p>More complex summaries can be generated by writing a custom function
that is then called by <code>profileApply()</code>. Note that each
profile is passed into this function and accessed via a temporary
variable (<code>i</code>), which is a <code>SoilProfileCollection</code>
object containing a single profile. See <code>help(profileApply)</code>
for details.</p>
<p>A list of <code>SoilProfileCollection</code> objects returned from a
custom function can be combined into a single
<code>SoilProfileCollection</code> object via
<code>combine()</code>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="co"># compute hz-thickness weighted mean exchangeable-Ca:Mg</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>wt.mean.ca.mg <span class="ot">&lt;-</span> <span class="cf">function</span>(i) {</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>  <span class="co"># use horizon thickness as a weight</span></span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>  thick <span class="ot">&lt;-</span> i<span class="sc">$</span>bottom <span class="sc">-</span> i<span class="sc">$</span>top</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>  </span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a>  <span class="co"># compute the thickness weighted mean, ignoring missing values</span></span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a>  <span class="fu">weighted.mean</span>(i<span class="sc">$</span>ex_Ca_to_Mg, <span class="at">w =</span> thick, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a>}</span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a><span class="co"># apply our custom function and save results as a site-level attribute</span></span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a>sp4<span class="sc">$</span>wt.mean.ca.to.mg <span class="ot">&lt;-</span> <span class="fu">profileApply</span>(sp4, wt.mean.ca.mg)</span></code></pre></div>
<p>We can now use our some of our new site-level attributes to order the
profiles when plotting.</p>
<p>In this case profiles are ordered based on the horizon-thickness
weighted mean, exchangeable Ca:Mg values. Horizons are colored by
exchangeable Ca:Mg values.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co"># plot the data using our new order based on Ca:Mg weighted average</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a><span class="co"># the result is an index of rank </span></span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>new.order <span class="ot">&lt;-</span> <span class="fu">order</span>(sp4<span class="sc">$</span>wt.mean.ca.to.mg)</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>)) <span class="co"># tighten figure margins</span></span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a><span class="fu">plotSPC</span>(sp4,</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>        <span class="at">name =</span> <span class="st">&#39;name&#39;</span>,</span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">&#39;ex_Ca_to_Mg&#39;</span>,</span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>        <span class="at">plot.order =</span> new.order)</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a><span class="co"># add an axis labeled with the sorting criteria</span></span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sp4), <span class="at">labels =</span> <span class="fu">round</span>(sp4<span class="sc">$</span>wt.mean.ca.to.mg, <span class="dv">3</span>), <span class="at">cex.axis =</span> <span class="fl">0.75</span>)</span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a><span class="fu">mtext</span>(<span class="dv">1</span>, <span class="at">line =</span> <span class="fl">2.25</span>, <span class="at">text =</span> <span class="st">&#39;Horizon Thickness Weighted Mean Ex. Ca:Mg&#39;</span>, <span class="at">cex =</span> <span class="fl">0.75</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="depth-wise-selection-and-resampling" class="section level1">
<h1>Depth-wise Selection and Resampling</h1>
<div id="slicing-horizons-dice" class="section level2">
<h2>Slicing Horizons: <code>dice()</code></h2>
<p>Collections of soil profiles can be sliced (or re-sampled) into
regular depth-intervals with the <code>dice()</code> function. The
slicing structure and variables of interest are defined via formula
notation:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="co"># slice select horizon-level attributes</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>seq <span class="sc">~</span> var<span class="fl">.1</span> <span class="sc">+</span> var<span class="fl">.2</span> <span class="sc">+</span> var<span class="fl">.3</span> <span class="sc">+</span> ...</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a><span class="co"># slice all horizon-level attributes</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>seq <span class="sc">~</span> .</span></code></pre></div>
<p>where <code>seq</code> is a sequence of integers
(e.g. <code>0:15</code>, <code>c(5,10,15,20)</code>, etc.) and
<code>var.1 + var.2 + var.3 + ...</code> are horizon-level attributes to
slice. Both continuous and categorical variables can be named on the
right-hand-side of the formula. The results returned by
<code>dice()</code> is either a <code>SoilProfileCollection</code>, or
<code>data.frame</code> when called with the optional argument
<code>SPC = FALSE</code>. For example, to slice our sample data set into
1-cm intervals, from 0–15 cm:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="co"># resample to 1cm slices</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">dice</span>(sp4, <span class="at">fm =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">15</span> <span class="sc">~</span> sand <span class="sc">+</span> silt <span class="sc">+</span> clay <span class="sc">+</span> name <span class="sc">+</span> ex_Ca_to_Mg)</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a><span class="co"># check the result</span></span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a><span class="fu">class</span>(s)</span></code></pre></div>
<pre><code>#&gt; [1] &quot;SoilProfileCollection&quot;
#&gt; attr(,&quot;package&quot;)
#&gt; [1] &quot;aqp&quot;</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="co"># plot sliced data</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>)) <span class="co"># tighten figure margins</span></span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a><span class="fu">plotSPC</span>(s, <span class="at">color =</span> <span class="st">&#39;ex_Ca_to_Mg&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACACAMAAADTa0c4AAABR1BMVEUAAAAvfb4wfaMwhKIwhL0xdb01baE1bbw2j7s2kKA2kLo4aro5lbk6OmY6Zjo6ZmY6ZpA6ZrY6kLY6kNs8Zp48Zrk8mbdAYrZOWJVOWK5eTopeTqFfvY9fvaZjwI5jwKVmOmZmZjpmZmZmZpBmZrZmkGZmkJBmkLZmkNtmtrZmtttmtv92yqKQOjqQOmaQZjqQZmaQZpCQkGaQkJCQkLaQkNuQtpCQtraQttuQtv+Q2/+eADieAEGg2aOl2qS2Zjq2Zma2Zra2kDq2kGa2kJC2kLa2tma2tpC2tra2ttu225C227a229u22/+2/9u2///D56HE56HSO0TSO0/VPk7aQ03bkGbbkJDbtmbbtpDbtrbb27bb29vb2//b/7bb///28JP3fEX85I3+w3L/tmb/tpD/trb/25D/27b/29v//7b//9v////ofrkRAAAACXBIWXMAAATrAAAE6wHYKlsNAAAGNklEQVR4nO2b61vbNhSH0127K2PdnbGuYSSMtcOJ08VhbLDFaUyXwLqtHQ6stOtaoOb//zxJTqSfgm9J/FgQ6TxPIedYlo5f6tfBJqVzzaOkugHVYQCobkB1qAIQWNXj8NXZ8Psj52RUKjIKBvB8Zd/9zSEvtjdf9J+v9AmJO+un5U1aWfz1A7/iFNtP0QCCO7dunLy3T158T774GzdIbWfP2quRH/3OrYXyyuNvCu3nvPD/ATur6zvl78iL/xa+3rMYgO317YVFuuneh7WN9xeL7UeNA4KBtyu/Gn1/tKoFgEsVBsD0uy4tyfn163J++7acP3gg50+eyPmzZ3L+9KmcP3wo51tbqS1miFkBnNr82s0A0PykwWoMANv+guUMAM1P7X2aMwAsD8eHAAZ8vhDAgM8XAhjw+UIAAz7fdDErgM7Lu6OcAaD5UVhjAGj+8hfWIANAc/fwH5ozACy/36I5A+A3ZAA0H87HANB8OB8DQPPhfNPFjA4IGsHuhTxwjzEP3MG+lNce35XGu/fh7c9g7N0gyWE+muN8LIf5Jo9ZJfj3D63xfGA1+1J+BA3T3IV9aG53EwFI89H8SAYgzTdxmKuA6gZUhwGgugHVYQCobkB1GACqG1AdBoDqBlSHAaC6AdVhAKhuQHUYAKobUB0GgOoGVIcBoLoB1WEAqG5AdRgAqhtQHQaA6gZUxxgAv+U7trfr9g/kp03+tw2/5zZd6W+Ygnqv6zr+ugtPrgLXbh047Qqpt8QstEr2dw4W6QJ0p5bYwTlwyD9Yj+xHKoHl0CW7tS7f5PYsMtDt1e61LlYCq14hw61m+LAyqHXpNof2k/TkTAYQuJ5r2/Vqu1lfk+rtim01bdtuSNUNh5Ta1TZgCexuo1617ZrtNsQstMr2r7i265HvbkPsQNar2bge2a9qN4JauKQlFm2TvL7Wblqraxcrg3KFjLZr7c1wXqtMt1VpP9KxJAKIDT/+z9ciN8nPjNNistEpc3Um+2ND44DxHCKtmmFw6hwTDc5lDrYhAcAyDxz1Gg+pn995RA/G0aVrPLC6JQLL7/KQFrzJAwcvRzf9F48xAPRL4O2eD3qepy+AwW7gHXmHSQDE1QMB+FAGAKIsAYDBAAAGIwAYDABwQQAAVQTQ8kcXZQTg45VQOuZ4AF+WhE8RgAdlACDKMPhVnAMAwGBx/D/iYACAC/Lj/woHL2PTh1EAPLw2JAPQQYKJAHRxgAGQAYCRoJFgctVIcDIHvMMjbwe8LuIySxAAnF0NADlLEAB0vMbQVblIEAG0Dke/W08pQQjQDISXVi5lmKPrnPYzD44uR1dLnWZUHxNI8G0eU58C16Kv+Hk4IPrkijkF/uUxySlgAAAA7qq8AUwtwWkBnJ3jLFkBOMRVFxdOl6A4/ldK3Hb5SBDeYnn8XmmcBAGAWDAVAITbHH2UY3oJctvlLkHxMZMsEhR95OqAn3nMpwO0B5AqQQAAXtNIggAAvKapBKO9diklyH47DI6jAVxFB3wsIrsDuv3o5wJX0QESANF0ogNinwtcRQcgAKczowP48b+FDgAAeEoCADitEQA4AADAYHH8WW6JAQBwgDj+j0jT3vFFABO8EYJIq87nLbGiJfiniGIlmAVAERLMHUBGCWYBUIgExfH/gV7TR4IIALxmJGgkOLsEf+KhqQQBgJ4SBABkQf5boj4SBABkQU/MkghAewl+ziNvCUabKsYBn/IoWoLTAkiXIHSZLkEAAAIrQoL8+D9DgeUhQehSOClOggCgA+UCJAgRczsrn1tiQyeNDY6ZObq7qCpKMHLBVADGAQZACgB0kpYSRCfpKcFYVV0ZCSZ+XkAbB/g99okBfQGc9tiTASPBWABGgvMrwUQA2jjAAJgWgJGgkaCRIC9fEgcsidDTAekA5twB4vi/wAWncwAAgPMXAOApCQDSnwsAAHAAAoCZAQAuCACgigBgQQBgngvEHvNsEvyEh6YSBAB6ShAAgNc0kiAAAK8ZCeouwTdF6CnBdABzLkFx/G+UhHw0kiACEPIxErw8Ehzm7CMTOkowDL/PPjKhowTDSH0wMr8SlA94PIeY9JZY9F2u5DtUY4NjZo7uLqqaeg8uDYB2YQCobkB1aA/gf2uc6oYO5UwdAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>Once soil profile data have been sliced, it is simple to extract
“chunks” of data by depth interval via <code>[</code>-subsetting:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="co"># slice from 0 to max depth in the collection</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">dice</span>(sp4, <span class="at">fm=</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(sp4) <span class="sc">~</span> sand <span class="sc">+</span> silt <span class="sc">+</span> clay <span class="sc">+</span> name <span class="sc">+</span> ex_Ca_to_Mg)</span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a><span class="co"># extract all data over the range of 5--10 cm:</span></span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a><span class="fu">plotSPC</span>(s[, <span class="dv">5</span><span class="sc">:</span><span class="dv">10</span>])</span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a><span class="co"># extract all data over the range of 25--50 cm:</span></span>
<span id="cb91-8"><a href="#cb91-8" tabindex="-1"></a><span class="fu">plotSPC</span>(s[, <span class="dv">25</span><span class="sc">:</span><span class="dv">50</span>])</span>
<span id="cb91-9"><a href="#cb91-9" tabindex="-1"></a></span>
<span id="cb91-10"><a href="#cb91-10" tabindex="-1"></a><span class="co"># extract all data over the range of 10--20 and 40--50 cm:</span></span>
<span id="cb91-11"><a href="#cb91-11" tabindex="-1"></a><span class="fu">plotSPC</span>(s[, <span class="fu">c</span>(<span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>, <span class="dv">40</span><span class="sc">:</span><span class="dv">50</span>)])</span></code></pre></div>
</div>
<div id="ragged-extraction-glom" class="section level2">
<h2>Ragged Extraction: <code>glom()</code></h2>
<p>Select all horizons that overlap the interval of 5-15cm:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="co"># truncate to the interval 5-15cm</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>clods <span class="ot">&lt;-</span> <span class="fu">glom</span>(sp4, <span class="at">z1 =</span> <span class="dv">5</span>, <span class="at">z2 =</span> <span class="dv">15</span>)</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a><span class="co"># plot outlines of original profiles</span></span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">1.5</span>)) </span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a><span class="fu">plotSPC</span>(sp4, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">name =</span> <span class="cn">NA</span>, <span class="at">print.id =</span> <span class="cn">FALSE</span>, <span class="at">depth.axis =</span> <span class="cn">FALSE</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>)</span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a><span class="co"># overlay glom() depth criteria</span></span>
<span id="cb92-9"><a href="#cb92-9" tabindex="-1"></a><span class="fu">rect</span>(<span class="at">xleft =</span> <span class="fl">0.5</span>, <span class="at">ybottom =</span> <span class="dv">15</span>, <span class="at">xright =</span> <span class="fu">length</span>(sp4) <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">ytop =</span> <span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb92-10"><a href="#cb92-10" tabindex="-1"></a></span>
<span id="cb92-11"><a href="#cb92-11" tabindex="-1"></a><span class="co"># add SoilProfileCollection with selected horizons</span></span>
<span id="cb92-12"><a href="#cb92-12" tabindex="-1"></a><span class="fu">plotSPC</span>(clods, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.6</span>, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">color =</span> <span class="st">&#39;ex_Ca_to_Mg&#39;</span>, <span class="at">name.style =</span> <span class="st">&#39;center-center&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACACAMAAADTa0c4AAAC5VBMVEUAAAAAOmYbRocbSocbWaMbXqIbXr0fPYYfTaEfUYUfZoUfZqAgPIUgS6AgarkiOoMiRociSYMiSZ4iSociVoIiWWsiWYciXmoiXocia74ibZ0lOIElRp0mPYYmTWomTYYmTaEnPIUnS2knS4UnUWknUYUnW7onZmknZoUoVIMoWWsoXmooaoMohL0rOmgrOoMrSWgrSYMrSZ4rVoIrbWcrbYIrbZ0sMnwsPpUtXoYtbbwuOIEuRmYuRoEuZmkvfb4wS2kwa4cwa6MwcqIwfaMwhKIwhL0xamgxlbkzSWgzWIMzZrkzg4Izmbc1XqE1baE1bbw2fKA2j7s2kKA2kLo4Mnw4PmI4Pnw4S644W4U4W6A4aqA4aro5lZ45lbk6OmY6Zjo6ZmY6ZpA6ZrY6kJA6kLY6kNs8WJ48Zp48Zrk8g508mZ08mbdAYrZBVJ1BYp1EPmJOS3xOS5VOWJVOWK5aenRam4xde3VdnI1eTqFeTrFeb7Feb8FmOmZmZjpmZmZmZpBmZrZmkDpmkGZmkJBmkLZmtrZmtttmtv9yenRym1xym3Rym4x2ITh2KkR2e3V2nFx2nHV2u6R2yqJ8jtGKunSK2aOOgGSOnFyOo3mQOjqQOmaQZjqQZmaQZpCQkDqQkGaQkJCQkLaQkNuQtpCQtraQttuQtv+Q2/+WITiWKiyWKjiXb6GXjsGXjtGXrMGeAEGeAGSguoyg2Yyg2aOlu3Wlu42l2o2l2qSwAEGwZqayjrGyrMGzgGSzo1Czo2SzxI22Zjq2Zma2Zra2kDq2kGa2kJC2kLa2tma2tpC2tra2ttu225C227a229u22/+2/9u2///AZobAkIbE56HQZkHSM0TSO0TSO0/Yo1DaQ03bkGbbkJDbtmbbtpDbtrbb27bb29vb2//b/7bb/9vb///y8vL28JP3fEX8xGT8xHn85Hn85I3+w3L/tmb/tpD/trb/25D/27b/29v//7b//9v///+9fLjvAAAACXBIWXMAAATrAAAE6wHYKlsNAAAHfklEQVR4nO2beXzTZBjHW2/FExTxnIoHnjgVb7wQ7xOneNduCnjfByrLdJWheCGe2HTt2EYVUVQUb2TSjHUom+IF0oowQQWBSfq3eXO8fd/uzdWkSdu8v8+W5nny5smTb968efu09WU8Lp/bCbgtCsDtBNyWGwB49qkeae0/+XVZ60bF5bQcBLC+rpv7tlVYmR/fsHh93WKBxLSGXiYOPDULqlOhVudyyco5APy02jEbA93CypvCIhUeI/jautiuiHDp22qDTN3KJxzLBZGDPaCtvqGNmSSs/Buc0MWKAOY3zA/WgE0Lb4mEb6pxLpesnB4D+HSyE19TXpfVewJA0YkCyGuv8eNxe9Qo3J46FbeXLMHt1atxe9063F6zBreXLsXt2bP1czQoKwB6Y8qzWwIA7I1NwCcBELdvALYEANi9MeERIAMQbbG9DCCtxJMBpJV4MoC0Ek8GkFbiWZAVAO2bpsu2BADYK0SfBADYm74BCUoAgM39/kdGASDai2ZkFACpJhwAsKV4EgBgS/EkAMCW4lmQhTGAb+I7+9g814PaPJfuxuzIyulYe24RMv1J58wGBRuJB2w0nmgj8fKTlUHwt+YZuXaabVmM2SuQhIHNIfsAO9ahCQCLB+wVOAAsXl6iTwG3E3BbFIDbCbgtCsDtBNwWBeB2Am6LAnA7AbdFAMAR6rNkX+7UVRHZvz6uuol4tHSyp6+vh+AQ/sGf3FxYJWWrJhwAz8aYaHVsub+pg+1GvGyQidRHg9E42nhBDRdt9If98D2c0C46KcUycY5t9DfKMYCzgY3Ug5aCLybsAsMkoiGWEf67YQBhn/poPNHoB4erhQcUNrDRUDgYY5qlxqijeYJwxKjQ/GYOHC8cjDBgk5iL/nvlnB6QiDBsdTRcXRtE921jgkwolqpOYQC4WCyWCtRWMzD/CLewgWVDPRzLBpQYklPYO8AG2GBEXFHCcMv9LBP2ZwFwwj6hVLwt7AeHi05QWvIcE1ruD4eYJwMyAMTxXaKuhwPNE2PE6xIICVcwXC3mYhoAWYk61UDkTSb6oJnuqi0+Eddv1Ed0EMwxEeXltRxA35tfANEvLDua8C6XC+BPKDTkOVA+nbYqAcje2VCo90YoYgT9sESvfKp854auZLqZS3ajXg8ByCSTq9qTLem0ZwHkyiEA5JvVMgBy2GIEcD1UsfcAMlMTAMgBrAMwfq1VnwKGAFRB5QngdChDAD770SAAwxlkfGuhCgyARNokgPe//+HTYgEgnQkCQD4x8CIc9/Ct5MNn/Z9AKe18GIDs/gKAaxUASFzsFoB+4czP3VECgMTNAkDjIpcg61+79m8EALw60uaUzkQInPrlhB4wctCAI3P54wBkp0oPuG7/wdufcbDBMeCGIw49z1APuBUK6wH/fDnvtV+/VnoABCAuU+2rNCdCVVWn9TtoyLaGbgFTAAYfsMM1uQDII5uJW0ANwLyv3viLDIBPcl2aE6GqK4YcuN0h/WwHQBwDfoGyFwA+BuA9IFc+fM3UIFisAPJ8DJYPgDlQeQAwMxEyAYAclgxAJ4UCA3gAygCAj4kAziIAIGdKBnAnlDEAY3UAmBsDyADIF2XuC1Mefv2lXABn7zxws8P2cAzA+f2HHmMPgIwGAHIPmDvlxUc+6gtg4G5bnOkYgHGVR+1SeaFLAEyMAYW8BfTGAAhA7L69rXhRzEsAxCWfxItilgbB0gCAnWCG78SLYuUJ4AOHHoOuAyA/neZ8+PTkB1951gsAxkPhACY/89DkV+2cB5ABkPibBPBTQQA49Ri8AwoBQO6VKgB+fmvmcwQAd5UygMugjACY+fbzfQHcfcrwvdwAIF41BABSe8IAQD8CwKfsjwJAalcogKwfHwNkvwBg+Kl7SwCQuNkMkLgYAOhHAPhQAPJEKGXbRMh6DyjQIKg9D8CLYuUIQLMgwifxolgZAlBTMQ6CFIBlAI95HMCj78364uV3vAxg1rufP24zgPsKA2BsqYwB9185+oR7rrYdwLihlTtdkFu8K04Ao6868d4CAKg8uj+o3el/gmGmLG4OgBiPa28umpmgGdnWA3iuVaUkJpllDyDR2qJSEpNMNQAj3AcwwpkxgAxg5IBBm7sMQEnBJQCDdt/SbQByCrrjpWoII94SGwNUvhCnEsKI1w4Al3gcwKX7VGx90n5eBlCx7zYVJxcjAHkiZN9ngyU5BvDtHUVTEjMj2wAkWlrsK4ndVoIAdLymANx+7LBdLzreywCGHbfnsIs9DKAkxwAdLwVAAXgdgE49Kl8Apt62EfO0AYD8w0ntkhj5NxhWAViXfTPBmHZJrNwB8EluomZJrNwB6HkpAAqAAiABID8ciQAsP/BUsncVgEpAIgBTORkXBWDfREi7JFbOAMQl36RdEit3AHwyMVGzJFbuAPS8FAAFQAFQABSAUQCkWW/BABj/PpVGiIw4D7BrIkQ+SoEA2KZkh9rvBiWz3AHw6Zj2l6TKHUAf5QKw+m621AFYj0cBUAAUAAVAAVAAFAAFQAFQABSAzaELI9sBFOizwYKpNLIsoCgAtxNwW54H8D+gmLNU6nV3HgAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
</div>
<div id="truncation-trunc" class="section level2">
<h2>Truncation: <code>trunc()</code></h2>
<p>Truncate the SPC to the interval of 5-15cm:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="co"># truncate to the interval 5-15cm</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>sp4.truncated <span class="ot">&lt;-</span> <span class="fu">trunc</span>(sp4, <span class="dv">5</span>, <span class="dv">15</span>)</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a><span class="co"># plot outlines of original profiles</span></span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">1.5</span>)) </span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a><span class="fu">plotSPC</span>(sp4, <span class="at">color =</span> <span class="cn">NA</span>, <span class="at">name =</span> <span class="cn">NA</span>, <span class="at">print.id =</span> <span class="cn">FALSE</span>, <span class="at">lwd =</span> <span class="fl">0.5</span>)</span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a><span class="co"># overlay truncation criteria</span></span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a><span class="fu">rect</span>(<span class="at">xleft =</span> <span class="fl">0.5</span>, <span class="at">ybottom =</span> <span class="dv">15</span>, <span class="at">xright =</span> <span class="fu">length</span>(sp4) <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">ytop =</span> <span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a></span>
<span id="cb93-11"><a href="#cb93-11" tabindex="-1"></a><span class="co"># add truncated SoilProfileCollection</span></span>
<span id="cb93-12"><a href="#cb93-12" tabindex="-1"></a><span class="fu">plotSPC</span>(sp4.truncated, <span class="at">depth.axis =</span> <span class="cn">FALSE</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">cex.names =</span> <span class="fl">0.6</span>, <span class="at">name =</span> <span class="st">&#39;name&#39;</span>, <span class="at">color =</span> <span class="st">&#39;ex_Ca_to_Mg&#39;</span>, <span class="at">name.style =</span> <span class="st">&#39;center-center&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="change-of-support" class="section level2">
<h2>Change of Support</h2>
<p>There is often a need for converting data to a new set of depth
intervals. This re-alignment of horizon depths via aggregation can be
considered a type of <em>change of support</em>. The operation on
<code>SoilProfileCollection</code> objects requires some aggregation
function (mean, median, etc.) and possibly interpolation
(e.g. splines).</p>
<div id="aggregation-over-slabs" class="section level3">
<h3>Aggregation over “slabs”</h3>
<p>The <code>slab()</code> function is the simplest way to implement a
change of depth support via aggregation. Profile grouping criteria and
horizon attribute selection is parameterized via formula: either
<code>groups ~ var1 + var2 + var3</code> where named variables are
aggregated within <code>groups</code> OR where named variables are
aggregated across the entire collection
<code>~ var1 + var2 + var3</code>. The default summary function
(<code>slab.fun</code>) computes the 5th, 25th, 50th, 75th, and 95th
percentiles via Harrell-Davis quantile estimator.</p>
<p>The depth structure (“slabs”) over which summaries are computed is
defined with the <code>slab.structure</code> argument using:</p>
<ul>
<li>a single integer (e.g. <code>10</code>): data are aggregated over a
regular sequence of 10-unit thickness slabs</li>
<li>a vector of 2 integers (e.g. <code>c(50, 60)</code>): data are
aggregated over depths spanning 50–60 units</li>
<li>a vector of 3 or more integers
(e.g. <code>c(0, 5, 10, 50, 100)</code>): data are aggregated over the
depths spanning 0–5, 5–10, 10–50, 50–100 units</li>
</ul>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="co"># aggregate a couple of the horizon-level attributes, </span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a><span class="co"># across the entire collection, </span></span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a><span class="co"># from 0--10 cm</span></span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a><span class="co"># computing the mean value ignoring missing data</span></span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a><span class="fu">slab</span>(</span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a>  sp4,</span>
<span id="cb94-7"><a href="#cb94-7" tabindex="-1"></a>  <span class="at">fm =</span> <span class="sc">~</span> sand <span class="sc">+</span> silt <span class="sc">+</span> clay,</span>
<span id="cb94-8"><a href="#cb94-8" tabindex="-1"></a>  <span class="at">slab.structure =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb94-9"><a href="#cb94-9" tabindex="-1"></a>  <span class="at">slab.fun =</span> mean,</span>
<span id="cb94-10"><a href="#cb94-10" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb94-11"><a href="#cb94-11" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>#&gt;   variable all.profiles value contributing_fraction top bottom
#&gt; 1     sand            1 47.63                     1   0     10
#&gt; 2     silt            1 31.15                     1   0     10
#&gt; 3     clay            1 21.11                     1   0     10</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co"># again, this time within groups defined by a site-level attribute:</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a><span class="fu">slab</span>(</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>  sp4,</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>  <span class="at">fm =</span> group <span class="sc">~</span> sand <span class="sc">+</span> silt <span class="sc">+</span> clay,</span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>  <span class="at">slab.structure =</span> <span class="fu">c</span>(<span class="dv">0</span>,  <span class="dv">10</span>),</span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>  <span class="at">slab.fun =</span> mean,</span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb96-8"><a href="#cb96-8" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>#&gt;   variable group value contributing_fraction top bottom
#&gt; 1     sand     A 48.26                     1   0     10
#&gt; 2     sand     B 47.00                     1   0     10
#&gt; 3     silt     A 31.52                     1   0     10
#&gt; 4     silt     B 30.78                     1   0     10
#&gt; 5     clay     A 20.30                     1   0     10
#&gt; 6     clay     B 21.92                     1   0     10</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="co"># again, this time over several depth ranges</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a><span class="fu">slab</span>(</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>  sp4,</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>  <span class="at">fm =</span> <span class="sc">~</span> sand <span class="sc">+</span> silt <span class="sc">+</span> clay,</span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>  <span class="at">slab.structure =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">40</span>),</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>  <span class="at">slab.fun =</span> mean,</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>#&gt;   variable all.profiles    value contributing_fraction top bottom
#&gt; 1     sand            1 47.63000             1.0000000   0     10
#&gt; 2     sand            1 42.38931             0.8733333  10     25
#&gt; 3     sand            1 32.14607             0.5933333  25     40
#&gt; 4     silt            1 31.15000             1.0000000   0     10
#&gt; 5     silt            1 29.41221             0.8733333  10     25
#&gt; 6     silt            1 31.34831             0.5933333  25     40
#&gt; 7     clay            1 21.11000             1.0000000   0     10
#&gt; 8     clay            1 28.10687             0.8733333  10     25
#&gt; 9     clay            1 36.26966             0.5933333  25     40</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="co"># again, this time along 1-cm slices, computing quantiles</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>agg <span class="ot">&lt;-</span> <span class="fu">slab</span>(sp4, <span class="at">fm =</span> <span class="sc">~</span> Mg <span class="sc">+</span> Ca <span class="sc">+</span> ex_Ca_to_Mg <span class="sc">+</span> CEC_7 <span class="sc">+</span> clay)</span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a><span class="co"># see ?slab for details on the default aggregate function</span></span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a><span class="fu">head</span>(agg)</span></code></pre></div>
<pre><code>#&gt;   variable all.profiles  p.q5  p.q25 p.q50  p.q75 p.q95 contributing_fraction top bottom
#&gt; 1       Mg            1 6.015 12.175 14.60 21.125 27.13                     1   0      1
#&gt; 2       Mg            1 6.015 12.175 14.60 21.125 27.13                     1   1      2
#&gt; 3       Mg            1 6.015 12.175 19.15 25.650 27.76                     1   2      3
#&gt; 4       Mg            1 6.195 13.175 21.05 25.050 30.73                     1   3      4
#&gt; 5       Mg            1 6.195 13.175 21.05 25.050 30.73                     1   4      5
#&gt; 6       Mg            1 6.195 13.175 21.05 26.250 31.72                     1   5      6</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="co"># plot median +/i bounds defined by the 25th and 75th percentiles</span></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a><span class="co"># this is lattice graphics, syntax is a little rough</span></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a><span class="fu">xyplot</span>(top <span class="sc">~</span> p.q50 <span class="sc">|</span> variable, <span class="at">data =</span> agg, <span class="at">ylab =</span> <span class="st">&#39;Depth&#39;</span>, </span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&#39;median bounded by 25th and 75th percentiles&#39;</span>,</span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>       <span class="at">lower =</span> agg<span class="sc">$</span>p.q25, <span class="at">upper =</span> agg<span class="sc">$</span>p.q75, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">42</span>, <span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a>       <span class="at">panel =</span> panel.depth_function,</span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a>       <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">sync.colors =</span> <span class="cn">TRUE</span>,</span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a>       <span class="at">par.settings =</span> <span class="fu">list</span>(<span class="at">superpose.line =</span> <span class="fu">list</span>(<span class="at">col =</span> <span class="st">&#39;RoyalBlue&#39;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)), </span>
<span id="cb102-9"><a href="#cb102-9" tabindex="-1"></a>       <span class="at">prepanel =</span> prepanel.depth_function,</span>
<span id="cb102-10"><a href="#cb102-10" tabindex="-1"></a>       <span class="at">cf =</span> agg<span class="sc">$</span>contributing_fraction, <span class="at">cf.col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">cf.interval =</span> <span class="dv">5</span>,</span>
<span id="cb102-11"><a href="#cb102-11" tabindex="-1"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>), <span class="at">strip =</span> <span class="fu">strip.custom</span>(<span class="at">bg =</span> <span class="fu">grey</span>(<span class="fl">0.8</span>)),</span>
<span id="cb102-12"><a href="#cb102-12" tabindex="-1"></a>       <span class="at">scales =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">list</span>(</span>
<span id="cb102-13"><a href="#cb102-13" tabindex="-1"></a>         <span class="at">tick.number =</span> <span class="dv">4</span>,</span>
<span id="cb102-14"><a href="#cb102-14" tabindex="-1"></a>         <span class="at">alternating =</span> <span class="dv">3</span>,</span>
<span id="cb102-15"><a href="#cb102-15" tabindex="-1"></a>         <span class="at">relation =</span> <span class="st">&#39;free&#39;</span></span>
<span id="cb102-16"><a href="#cb102-16" tabindex="-1"></a>       ))</span>
<span id="cb102-17"><a href="#cb102-17" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Depth-wise aggregation can be useful for visual evaluation of
multivariate similarity among groups of profiles.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="co"># processing the &quot;napa&quot; and tehama profiles</span></span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>idx <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">profile_id</span>(sp4) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;napa&#39;</span>, <span class="st">&#39;tehama&#39;</span>))</span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>napa.and.tehama <span class="ot">&lt;-</span> <span class="fu">slab</span>(sp4[idx,], <span class="at">fm =</span> <span class="sc">~</span> Mg <span class="sc">+</span> Ca <span class="sc">+</span> ex_Ca_to_Mg <span class="sc">+</span> CEC_7 <span class="sc">+</span> clay)</span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a><span class="co"># combine with the collection-wide aggregate data</span></span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">make.groups</span>(<span class="at">collection =</span> agg, <span class="at">napa.and.tehama =</span> napa.and.tehama)</span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a><span class="co"># compare graphically:</span></span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a><span class="fu">xyplot</span>(top <span class="sc">~</span> p.q50 <span class="sc">|</span> variable, <span class="at">groups =</span> which, <span class="at">data =</span> g, <span class="at">ylab =</span> <span class="st">&#39;Depth&#39;</span>,</span>
<span id="cb103-10"><a href="#cb103-10" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&#39;median bounded by 25th and 75th percentiles&#39;</span>,</span>
<span id="cb103-11"><a href="#cb103-11" tabindex="-1"></a>       <span class="at">lower =</span> g<span class="sc">$</span>p.q25, <span class="at">upper =</span> g<span class="sc">$</span>p.q75, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">42</span>, <span class="sc">-</span><span class="dv">2</span>),</span>
<span id="cb103-12"><a href="#cb103-12" tabindex="-1"></a>       <span class="at">panel =</span> panel.depth_function,</span>
<span id="cb103-13"><a href="#cb103-13" tabindex="-1"></a>       <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">sync.colors =</span> <span class="cn">TRUE</span>, <span class="at">cf =</span> g<span class="sc">$</span>contributing_fraction, <span class="at">cf.interval =</span> <span class="dv">10</span>,</span>
<span id="cb103-14"><a href="#cb103-14" tabindex="-1"></a>       <span class="at">par.settings =</span> <span class="fu">list</span>(<span class="at">superpose.line =</span> <span class="fu">list</span>(</span>
<span id="cb103-15"><a href="#cb103-15" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;RoyalBlue&#39;</span>, <span class="st">&#39;Red4&#39;</span>),</span>
<span id="cb103-16"><a href="#cb103-16" tabindex="-1"></a>         <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb103-17"><a href="#cb103-17" tabindex="-1"></a>         <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb103-18"><a href="#cb103-18" tabindex="-1"></a>       )),</span>
<span id="cb103-19"><a href="#cb103-19" tabindex="-1"></a>       <span class="at">prepanel =</span> prepanel.depth_function,</span>
<span id="cb103-20"><a href="#cb103-20" tabindex="-1"></a>       <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">1</span>), </span>
<span id="cb103-21"><a href="#cb103-21" tabindex="-1"></a>       <span class="at">strip =</span> <span class="fu">strip.custom</span>(<span class="at">bg =</span> <span class="fu">grey</span>(<span class="fl">0.8</span>)),</span>
<span id="cb103-22"><a href="#cb103-22" tabindex="-1"></a>       <span class="at">scales =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">list</span>(</span>
<span id="cb103-23"><a href="#cb103-23" tabindex="-1"></a>         <span class="at">tick.number =</span> <span class="dv">4</span>,</span>
<span id="cb103-24"><a href="#cb103-24" tabindex="-1"></a>         <span class="at">alternating =</span> <span class="dv">3</span>,</span>
<span id="cb103-25"><a href="#cb103-25" tabindex="-1"></a>         <span class="at">relation =</span> <span class="st">&#39;free&#39;</span></span>
<span id="cb103-26"><a href="#cb103-26" tabindex="-1"></a>       )),</span>
<span id="cb103-27"><a href="#cb103-27" tabindex="-1"></a>       <span class="at">auto.key =</span> <span class="fu">list</span>(<span class="at">columns =</span> <span class="dv">2</span>,</span>
<span id="cb103-28"><a href="#cb103-28" tabindex="-1"></a>                       <span class="at">lines =</span> <span class="cn">TRUE</span>,</span>
<span id="cb103-29"><a href="#cb103-29" tabindex="-1"></a>                       <span class="at">points =</span> <span class="cn">FALSE</span>)</span>
<span id="cb103-30"><a href="#cb103-30" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The following example is based on a set of 9 randomly generated
profiles, re-aligned to the Global Soil Map (GSM) standard depths.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a><span class="co"># 9 random profiles</span></span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a><span class="co"># 1 simulated property via logistic power peak (LPP) function</span></span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a><span class="co"># 6, 7, or 8 horizons per profile</span></span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a><span class="co"># result is a list of single-profile SPC</span></span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">lapply</span>(</span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a>  <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>), </span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a>  random_profile, </span>
<span id="cb104-10"><a href="#cb104-10" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>), </span>
<span id="cb104-11"><a href="#cb104-11" tabindex="-1"></a>  <span class="at">n_prop =</span> <span class="dv">1</span>, </span>
<span id="cb104-12"><a href="#cb104-12" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">&#39;LPP&#39;</span>,</span>
<span id="cb104-13"><a href="#cb104-13" tabindex="-1"></a>  <span class="at">SPC =</span> <span class="cn">TRUE</span></span>
<span id="cb104-14"><a href="#cb104-14" tabindex="-1"></a>)</span>
<span id="cb104-15"><a href="#cb104-15" tabindex="-1"></a></span>
<span id="cb104-16"><a href="#cb104-16" tabindex="-1"></a><span class="co"># combine into single SPC</span></span>
<span id="cb104-17"><a href="#cb104-17" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">combine</span>(d)</span>
<span id="cb104-18"><a href="#cb104-18" tabindex="-1"></a></span>
<span id="cb104-19"><a href="#cb104-19" tabindex="-1"></a><span class="co"># GSM depths</span></span>
<span id="cb104-20"><a href="#cb104-20" tabindex="-1"></a>gsm.depths <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">30</span>, <span class="dv">60</span>, <span class="dv">100</span>, <span class="dv">200</span>)</span>
<span id="cb104-21"><a href="#cb104-21" tabindex="-1"></a></span>
<span id="cb104-22"><a href="#cb104-22" tabindex="-1"></a><span class="co"># aggregate using mean: wt.mean within slabs</span></span>
<span id="cb104-23"><a href="#cb104-23" tabindex="-1"></a><span class="co"># see ?slab for ideas on how to parameterize slab.fun</span></span>
<span id="cb104-24"><a href="#cb104-24" tabindex="-1"></a>d.gsm <span class="ot">&lt;-</span> <span class="fu">slab</span>(d, <span class="at">fm =</span> id <span class="sc">~</span> p1, <span class="at">slab.structure =</span> gsm.depths, <span class="at">slab.fun =</span> mean, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb104-25"><a href="#cb104-25" tabindex="-1"></a></span>
<span id="cb104-26"><a href="#cb104-26" tabindex="-1"></a><span class="co"># note: result is in long-format</span></span>
<span id="cb104-27"><a href="#cb104-27" tabindex="-1"></a><span class="co"># note: horizon names are lost due to aggregation</span></span>
<span id="cb104-28"><a href="#cb104-28" tabindex="-1"></a><span class="fu">head</span>(d.gsm, <span class="dv">7</span>)</span></code></pre></div>
<pre><code>#&gt;   variable id    value contributing_fraction top bottom
#&gt; 1       p1  1 23.58824            1.00000000   0      5
#&gt; 2       p1  1 23.58824            1.00000000   5     15
#&gt; 3       p1  1 23.64121            1.00000000  15     30
#&gt; 4       p1  1 23.74111            1.00000000  30     60
#&gt; 5       p1  1 21.29521            1.00000000  60    100
#&gt; 6       p1  1 20.30463            0.01923077 100    200
#&gt; 7       p1  2 16.45976            1.00000000   0      5</code></pre>
<p>A simple graphical comparison of the original and re-aligned soil
profile data, after converting <code>slab()</code> result from long
-&gt; wide format with {data.table} <code>dcast()</code>:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="co"># reshape to wide format</span></span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a><span class="co"># this scales to &gt; 1 aggregated variables</span></span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>d.gsm.pedons <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">dcast</span>(</span>
<span id="cb106-4"><a href="#cb106-4" tabindex="-1"></a>  <span class="fu">data.table</span>(d.gsm), </span>
<span id="cb106-5"><a href="#cb106-5" tabindex="-1"></a>  <span class="at">formula =</span> id <span class="sc">+</span> top <span class="sc">+</span> bottom <span class="sc">~</span> variable, </span>
<span id="cb106-6"><a href="#cb106-6" tabindex="-1"></a>  <span class="at">value.var =</span> <span class="st">&#39;value&#39;</span></span>
<span id="cb106-7"><a href="#cb106-7" tabindex="-1"></a>)</span>
<span id="cb106-8"><a href="#cb106-8" tabindex="-1"></a></span>
<span id="cb106-9"><a href="#cb106-9" tabindex="-1"></a><span class="co"># init SPC</span></span>
<span id="cb106-10"><a href="#cb106-10" tabindex="-1"></a><span class="fu">depths</span>(d.gsm.pedons) <span class="ot">&lt;-</span> id <span class="sc">~</span> top <span class="sc">+</span> bottom</span>
<span id="cb106-11"><a href="#cb106-11" tabindex="-1"></a></span>
<span id="cb106-12"><a href="#cb106-12" tabindex="-1"></a><span class="co"># iterate over aggregated profiles and make new hz names</span></span>
<span id="cb106-13"><a href="#cb106-13" tabindex="-1"></a>d.gsm.pedons<span class="sc">$</span>hzname <span class="ot">&lt;-</span> <span class="fu">profileApply</span>(d.gsm.pedons, <span class="cf">function</span>(i) {</span>
<span id="cb106-14"><a href="#cb106-14" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">&#39;GSM-&#39;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(i))</span>
<span id="cb106-15"><a href="#cb106-15" tabindex="-1"></a>})</span>
<span id="cb106-16"><a href="#cb106-16" tabindex="-1"></a></span>
<span id="cb106-17"><a href="#cb106-17" tabindex="-1"></a><span class="co"># compare original and aggregated</span></span>
<span id="cb106-18"><a href="#cb106-18" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb106-19"><a href="#cb106-19" tabindex="-1"></a><span class="fu">plotSPC</span>(d, <span class="at">color =</span> <span class="st">&#39;p1&#39;</span>)</span>
<span id="cb106-20"><a href="#cb106-20" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;original depths&#39;</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="sc">-</span><span class="fl">1.5</span>)</span>
<span id="cb106-21"><a href="#cb106-21" tabindex="-1"></a><span class="fu">plotSPC</span>(d.gsm.pedons, <span class="at">color =</span> <span class="st">&#39;p1&#39;</span>)</span>
<span id="cb106-22"><a href="#cb106-22" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;GSM depths&#39;</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="sc">-</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Note that re-aligned data may not represent reality (and should
therefore be used with caution) when the original soil depth is
shallower than the deepest of the new (re-aligned) horizon depths. The
<code>contributing_fraction</code> metric returned by
<code>slab()</code> can be useful for assessing how much <em>real</em>
data were used to generate the new set of re-aligned data.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="co"># reshape to wide format</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>d.gsm.pedons<span class="fl">.2</span> <span class="ot">&lt;-</span> data.table<span class="sc">::</span><span class="fu">dcast</span>(</span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>  <span class="fu">data.table</span>(d.gsm), </span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>  <span class="at">formula =</span> id <span class="sc">+</span> top <span class="sc">+</span> bottom <span class="sc">~</span> variable, </span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>  <span class="at">value.var =</span> <span class="st">&#39;contributing_fraction&#39;</span></span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a>)</span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a></span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a><span class="co"># init SPC</span></span>
<span id="cb107-9"><a href="#cb107-9" tabindex="-1"></a><span class="fu">depths</span>(d.gsm.pedons<span class="fl">.2</span>) <span class="ot">&lt;-</span> id <span class="sc">~</span> top <span class="sc">+</span> bottom</span>
<span id="cb107-10"><a href="#cb107-10" tabindex="-1"></a></span>
<span id="cb107-11"><a href="#cb107-11" tabindex="-1"></a><span class="co"># compare original and aggregated</span></span>
<span id="cb107-12"><a href="#cb107-12" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb107-13"><a href="#cb107-13" tabindex="-1"></a><span class="fu">plotSPC</span>(d.gsm.pedons, <span class="at">name =</span> <span class="st">&#39;&#39;</span>, <span class="at">color =</span> <span class="st">&#39;p1&#39;</span>)</span>
<span id="cb107-14"><a href="#cb107-14" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;GSM depths&#39;</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="sc">-</span><span class="fl">1.5</span>)</span>
<span id="cb107-15"><a href="#cb107-15" tabindex="-1"></a></span>
<span id="cb107-16"><a href="#cb107-16" tabindex="-1"></a><span class="fu">plotSPC</span>(</span>
<span id="cb107-17"><a href="#cb107-17" tabindex="-1"></a>  d.gsm.pedons<span class="fl">.2</span>,</span>
<span id="cb107-18"><a href="#cb107-18" tabindex="-1"></a>  <span class="at">name =</span> <span class="st">&#39;&#39;</span>,</span>
<span id="cb107-19"><a href="#cb107-19" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&#39;p1&#39;</span>,</span>
<span id="cb107-20"><a href="#cb107-20" tabindex="-1"></a>  <span class="at">col.label =</span> <span class="st">&#39;Contributing Fraction&#39;</span>,</span>
<span id="cb107-21"><a href="#cb107-21" tabindex="-1"></a>)</span>
<span id="cb107-22"><a href="#cb107-22" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&#39;GSM depths&#39;</span>, <span class="at">side =</span> <span class="dv">2</span>, <span class="at">line =</span> <span class="sc">-</span><span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="pair-wise-dissimilarity-ncsp" class="section level1">
<h1>Pair-Wise Dissimilarity: <code>NCSP()</code></h1>
<p>Calculation of between-profile dissimilarity is performed using
<code>NCSP()</code> (Numerical Classification of Soil Profiles). As of
aqp 2.0, <code>NCSP()</code> replaces the older implementation in
<code>profile_compare()</code> which is now deprecated. Dissimilarity
values depend on attributes selection (e.g. clay, CEC, pH , etc.),
optional depth-weighting parameter (<code>k</code>), and a maximum depth
of evaluation (<code>maxDepth</code>).</p>
<p>See the <a href="http://ncss-tech.github.io/aqp/reference/NCSP.html">function
manual page</a> and <a href="http://dx.doi.org/10.1016/j.cageo.2012.10.020">this paper</a> for
details.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a><span class="co"># start fresh</span></span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a><span class="fu">data</span>(sp4)</span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a><span class="fu">depths</span>(sp4) <span class="ot">&lt;-</span> id <span class="sc">~</span> top <span class="sc">+</span> bottom</span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a><span class="fu">hzdesgnname</span>(sp4) <span class="ot">&lt;-</span> <span class="st">&#39;name&#39;</span></span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a><span class="co"># eval dissimilarity:</span></span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a><span class="co"># using Ex-Ca:Mg ratio and CEC at pH 7</span></span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a><span class="co"># no depth-weighting (k = 0)</span></span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a><span class="co"># to a maximum depth of 40 cm</span></span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">NCSP</span>(sp4, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&#39;ex_Ca_to_Mg&#39;</span>, <span class="st">&#39;CEC_7&#39;</span>), <span class="at">k =</span> <span class="dv">0</span>, <span class="at">maxDepth =</span> <span class="dv">40</span>)</span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a></span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a><span class="co"># check distance matrix:</span></span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a><span class="fu">round</span>(d, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>#&gt;                colusa glenn kings mariposa mendocino napa san benito shasta shasta-trinity
#&gt; glenn            13.8                                                                     
#&gt; kings            16.0  13.1                                                               
#&gt; mariposa          8.4  11.6  16.5                                                         
#&gt; mendocino        12.1   8.2  17.0     15.5                                                
#&gt; napa             31.5  24.9  30.5     30.3      22.2                                      
#&gt; san benito       26.8  21.4  27.4     29.3      16.4 18.0                                 
#&gt; shasta           17.2  13.6   8.7     17.6      17.6 34.8       23.3                      
#&gt; shasta-trinity    6.4  16.9  22.3      9.6      17.0 30.9       28.3   23.3               
#&gt; tehama           30.1  23.9  29.2     28.6      20.8  9.0       15.3   32.7           29.2</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="co"># visualize dissimilarity matrix via divisive hierarchical clustering</span></span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>d.diana <span class="ot">&lt;-</span> <span class="fu">diana</span>(d)</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a></span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a><span class="co"># may require some margin adjustments</span></span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">0</span>))</span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" tabindex="-1"></a><span class="fu">plotProfileDendrogram</span>(</span>
<span id="cb110-8"><a href="#cb110-8" tabindex="-1"></a>  sp4,</span>
<span id="cb110-9"><a href="#cb110-9" tabindex="-1"></a>  d.diana,</span>
<span id="cb110-10"><a href="#cb110-10" tabindex="-1"></a>  <span class="at">scaling.factor =</span> <span class="fl">0.9</span>,</span>
<span id="cb110-11"><a href="#cb110-11" tabindex="-1"></a>  <span class="at">y.offset =</span> <span class="dv">5</span>,</span>
<span id="cb110-12"><a href="#cb110-12" tabindex="-1"></a>  <span class="at">cex.names =</span> <span class="fl">0.7</span>,</span>
<span id="cb110-13"><a href="#cb110-13" tabindex="-1"></a>  <span class="at">width =</span> <span class="fl">0.3</span>,</span>
<span id="cb110-14"><a href="#cb110-14" tabindex="-1"></a>  <span class="at">color =</span> <span class="st">&#39;ex_Ca_to_Mg&#39;</span>,</span>
<span id="cb110-15"><a href="#cb110-15" tabindex="-1"></a>  <span class="at">name.style =</span> <span class="st">&#39;center-center&#39;</span>,</span>
<span id="cb110-16"><a href="#cb110-16" tabindex="-1"></a>  <span class="at">hz.depths =</span> <span class="cn">TRUE</span>,</span>
<span id="cb110-17"><a href="#cb110-17" tabindex="-1"></a>  <span class="at">depth.axis =</span> <span class="cn">FALSE</span></span>
<span id="cb110-18"><a href="#cb110-18" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAADACAIAAAD6NS2RAAAACXBIWXMAAATrAAAE6wHYKlsNAAAS4UlEQVR4nO3dW3AbVZoH8H/vbOU2GycmNjhxLnYiaZlesUlMcEhCargEEo2WxJApT81sQYCqjV62SKpmUzwsPK3nYco8SFPUVpmpGmbDzm7hWsDAWj0sYVkqQDIJJGRQdVE6HWJCTJzb+MKSC1Vb2gfJjpzIUp9WS91H+v8egrCOPn3drU/dOufoSMtkMiAiNf2Z1wkQkXMsYCKFsYCJFMYCJlIYC5hIYSxgIoWxgIkUxgImUhgLmEhhLODaYCVisVjCsArfaRX8u5WIJQxr8j+kJBawOoxELJYwACORMCwjv+iM2C7s6+sLQViTza7faSV27eo1LFhGLBZL5FWqMFP9A8IY7E+ZaRiJWCLBQlYOC1gVVqKnH+jvSViRKHp2DYQigam70qlwKABEIpEALEBHf8/gVCkGQuFwVwSJ3oGuvn3ozS/hcBg9PWY4DLN3APv2hMwBUd2NonKxgFURCIXD0MPhEIxeMxzGgHH9rj3PoicWi22KGbAGB8ybHpsaMBBCqifW249QIO+Orq4w9C4duo7+XbGeVBW2g1yl8dtIyrIsQwgACEYiAdv3Fv67lYj1Aimz68O+SEWTJnexgIkUxktoIoWxgIkUxgKeZteO/bt27Lfffn38wPr4Afvtnzn68jNHX7bf/sOR/R+OSORzZfyFK+Mv2G+f+eDnmQ9+br/91eceuvrcQ/bbiy3bxZbt9tu/pN3/kna//fbEAi7KMhKJhMTYaH57y8a46g3xDZn2lpFIJAy59qXHea2SOczU3s723hDfxnPlxbexvXUoQzNLxpOZTDIeFw7aCyFKPnZ6/GRydzJpO34yHhciKYqmdkP7pIjHiz6BSMbj8aTdrZ3e3s72To9fenvz29vZ3jrEM3ARVhoAgqGQk/aBAIxEOrrn5gGegu0tI5EOdtmPb6VNIIDBwSLnsIL5FzvnBSJ7onY39sb2NrY3v72d7Z3W3sb21iMWcBGBKNIJYzCNYi/Kgu0tw0jEetOhkChaL3ntRTAalYkvQjoGjfT0eRnF8kkDqNg8K3vbm9/ezvZOa29je+sRx4GJFMYzMJHCWMBECmMBEymMBUykMBYwkcJYwEQK+3OvE6AZaZrmdQp1RNHxVBawryn6qlKOuu+VvIQmUhgLmEhhLGAihbGAiRTGAiZSGAuYSGEsYCKFsYCJFMYCJlIYC5hIYSxgIoVxLnQB/pkZ64dMOB/bz1jAhfFVm+WHdxAqgpfQRApjARMpjAVMpDAWMJHC2IlFtaD8zrYyI3jV66lqAVe6d7TS8dnL7ToPd6mHffWqFjBUrgGOzZBb+BmYSGEsYCKFsYCJFMYCJlIYC5hIYSxgIoV5NoxUtyPvRC7ychy4xkbepWLab1yJvaRKqqrk6SGFJ3L4kLevYCmqpKpKnl5xs4Bld019vmUSucjlM7Dn13tEdYW90EQKYwETKYwFTKQwFjCRwljARApjARMpjAVMpDCNcySI1MUzMJHCWMBECmMBEymMBUykMHcK2EgkLLcjWIZh3XQ7/4aR10CK5fSBBZW/7TZDl5N2NpK7G45SR81zU8lU7hgV3AOOX5kOOO6FthKxXui6aZq6jn5T79YRDZnBHsS7u0KhdHrADPX1RezG6YI5AB0mdN3s70e4Oxu5S8eAiS7d7DERhr6vLzSYSMME0G8ijFRK734WwJ49hZ7ISsR6AUCHGerbh8TggGliMohpQk/t7Q/Hu7P/SuU8LX4/EAZ06KZu6kC/iW4diPbtCUgEgQ4ztE8f6EUuTmpvfzgeTu1NXc8QSAMmsnd1238KADASm3rMZ5/V0+mpCLngXdE9Edthpqdd9KjJ7MkbUo2lkY1pmoCei+8goJWI7epHuBu6CVPPzxPTXhVSL9Ts68TUoQOI9oUGY+nc/rz+AggjlUJY5mXgnOMzcCCkAyaAyX9hDg6kNoZ10+zpGTDtBwrpumkOmLoeDeHFfhNAOHvs9FR/jwkgFIx2dQPQo7l9oUdDOqDrevhZmD2Izrz39ZCuh0IArMFsSvpUEMAMbwRgwkHOAIBAaGrTAVOHPplYNKTLxJlKMj9O90YAyGYY3hgGzHR2A3J3ySaL7m49nc6LYCK74QNCNhIAG0etDNdjAoCZun5bTiCkAymYOnQ9P+ZNrwp7Qnr+62TyKJu5Y5H/AtD1cDjl4Bg5klGYSMZ3x4WTRybjzh53Q5Ddu3fHk2XHqT5VMnflMNU2TuQgUpiTFTmcLZFR/J3C8bIbRcJWIqbjsKrELB6Wu9T1mGVyuKTO33/4slT7FzY9pmklzvYOYmYymeJh7/7Vf0nFPPz0QyVjOgtbMuadvQekYn6yb0vJmB9feEkq5rrmJ0tu/t5DcocpvqH0YQLwG9xnP+ZTeM9OzNTmHfZjAggffKNkzC3735KKeeDxh0vGLEf1xoEzGSHZwX7iRP8JADhz4sThczO0sZLJpNud9pWICfmYR84fPFK8hfwutUOVXVqRw1SJXVqZw5TjVgFPFltRQZmI44dHFmLkSwBLWxa6FBMAcHTk/aPFW8jHLE025rXPz8zBmQm3w9ohH/PE8VdKHH1/5Hnu5eGZzgTlhC2tEjGz3FmVcvzwyELgS6xeUaxVIBAJFBkVe2HTYwX+mvjXIhE1LZjJZKRG2q6aZ2YDo7irccYmJfJ0JhApMdz6yb4tBf765j8Xjyqf6mf/3oefxu5wMebYoZFGYAir29yLaYN0zNOj/9sGHMStm1Hko6wvUrXPlQI+N4aWhRsxdPjcirtvcxxlzT+9K9X+0+cekH+Sr69g6dy/wpj5NfQl8g+voDXP/LdU+09/eb+DZ/nq3ZHlwIe4Y5ODBxeWO/qnDp1r2+D86Ffet1/iL1bcgvdHL29u/L7XybjGYQEXPlsCB8tIxYGSPRmHn35opruGZvh7Rbsc3CWf6vnTaFn+ID549/ymB2519qTxDYUPPYD3Z/i7o136YEccx/a+I/moacIH3yj491/O/BCFjn6WwwK+7zeDUu3feyoqv2uOXDiE5g2dE4deBZbN2tA5p1AjIZKGYc10feqga9dO96ZPZDIZyzKECJa6PJ9ya7Zuf7rS+ZNWqGP/BrfsbhsDVgJfSKaX7/+GeqXaf69tX26XwvYe9Vr1fhtJdtdcFV/NBibQ2bDh7olDwzM1EwJBt3e2EEnDghKHsPjmr2t+UjZgdqjT9fcvyV26aiGGxvrRtnsVXjzpbialWBAALNj90PrJ6bexfOudFc2piGr+uJnUrhn+Dstm/SW+EcMTF1+51vSTWTO0i0SczZkvQvYQAjg68j5afniX25mUVnzzB07Jjdl2tT+WyWQsI+H2+5fsLj35xYsnAfzpIxdzsEmuw+nyH4e/D1zCnYsqmFIx1SzgErumaKdU4Sv2ylzrSvcZ2ujZljPxxasA0LgTo39oaMSF0aXNK1tdil2SBYQgADcLuILdsDb9/r2DALByM774fNtK/OqLpqfvayo76tkraJ27Bhf/eHbRXy8uO5oT5Rfwx2fewdIH11367A0AuG0Hzn286I51DgKt/Qe5Xujjzz+Q/XAlJEeS3FaBnu0/AcC1RswG0Lh09qg7Ue3xvtgq4hQApFciBGBFU6icz9bXLc7W7XLvet/LLeArnw3PBS5hHUYA4MptmOtCVhKSybiQutp135JGfQmAlvLf0PPdAlS1bj32FN6Tau/ks3p7eX1ivlRmAZ+9jNZ5q3Hps7NzAbQApSe6uMsKIiS8rmDXNazbOXlzPYCGMjqNVXFio8S85dUfvZHJCMMQ9j+rb3tqM4BtAHA7gG0SM699rcwCXrzojsUAlt4K3DF1AJxcPztVo9d7ZFPR9+7vte2TjadpWkYIK6DMi6qanVhELio5ORX/cVKuE/7Hqx7LZDKwDIUq2GEBv/dUVPYhqsyO8IqDqZHcpZVgCQRnHps78PjDsgErepgcFvDmv/u9VPuDv96WyQjDSABR25Ncjlw4huaOzvFTrwLAwp0Lyh6lmfj8NQBoehQXjzQ04fzF1ltvr9rwTAmOOuHldumx/3kbANq34tSJjna8darl4Xv9PHvZG4GiQ+t37pWc2xffIv/Kl1DVS+ggosL2F6uunfpqFjCOzmxn7HdFvlJo3wUAuNqEOQCaWudcdBimyBTrmVTobVhql2aHUobb0QpgRUvrKdfTocLkDpOMKk/ksD87YPgqls1px8Sp4VkAGoExwJV5Es2A07qd4mA+cPE5205J7VIAQHuujKmK5A+Tbb7txGpd0N4KoLkRaN9ZsrVNDZsfBdAAAJ0AGm53K3Bpwtnyra7qeHIrgA4AWA2g415PsyE3+LaAa00F5mwT8beRiFTGMzDVheN5PfAYGgFaWp5Y7c33D1zlowI+/rz0EjkV+vIq1aAhAPi6HUuAtU+sOf7bEY/zcYmPCvhHf1t4AZSZJH+3Y+rLq0FILUxBdakt1wN//LfJr9t+1OJxNu7wUQE7EwiGRGXW5agBXe0zrl81E59c1HwwdhIA5qzE1fP3LHRhtsnaJ7YCWAsAq4HVa8uP6A/KF3Bu4kyAfbwFbP23N6Xav/2z7dMuajxcGuoKAHw5B0UXKqYaKOCiCi+2XJRPTkEeCgRDwsm6Qm6bC1z17Mltmhh6DQAWPoqxIw1tndVPoMYLePU/yi22fOIX918/BYmECDr59Wvl5S5qvPxCzj2LVwG4BwD8PVt7FACuLkTBJVOrgOPABQSCoetLQxEVl53n65EaPwM75INTEHlC0zSRjItgNNsvWvL6q2HttMm51ccCppr141XSnfC5L/Rn/0eFpZpYwFSbnHdDTl5/uZlNxfAzMJHC/HsGvvD1WwAw/2F8c6x5Poa+Wdy2pAbmrhK5ycdn4AlgAt9mb89fXDs/CEnkHh8XMIAG4BuvcyDyMRcuoUe/eh0AFjyC8aONCzA8vqR1mQsrxTXf/jCAZiC7hkSzv36Ou7Km1vHD2BGMfgUsm9PROdvrrMiH3PgMPA4AlxdgHoCGJfPGXQhZ7ybX8ZsFLOi4e/zYjL+uWs80TUsmkwBgZ8TWO5qmCZGcXFPJ5VRd6sRakCtjcs3k/J7xY6981/gTr2bqVc3qj+S+TJqt3mAkCKOqy419EpeeXZ/JZAzDqFCqLhRwY/gR5FaMvAtA47LyQ9a7BR1T6/h1ot2bKT7VVNZXR6r42zqO88ytiFaBVP3diUVERbGAXTBqvj5qvj56EaPmUa9z8UCdb763WMBuuABcwDWvs/BMnW++p1jALmkGznudg4fqfPO946OplMnfSfzEc5ZPVs9o/OEjkzfv8jIPj9T55nvLRwX8+PZ/kWq//81dmUzGsgzDsIJB4eUCTkQe8VEBOyOyv+ZqwM4CTt+cfBUAGndi9A+4dAZYOqtzPWc4kbqUL2C5EbZLAHCtEbOBhs67J46cqWRqRBVXf51Yi3ITFSeOvHJt0VKvsyEqi/JnYCnzO3cCmA8A67Fq/XyP0yEqV/2dgYlqSH2dgevcxU/fBIDF23H2GM6eAZbOi3TM8zorKgfPwPXkLHA2t8hJU4RjtrWABVxnFgNnAeCi8dq3i7nGmPJ4CV1HmiLbATQBQAfWdDR5nA65gGdgIoWxgIkUxktoheUWW0IQQvh8XSiqEIcFfPDX22Qfomma518b8rPjzz8g+5BMRliGAEQQ/B3FOuWwgB1/c4ini4Icv7UFJieBc2/Wp2p+BrYgACGCVXxKotpWzc/AAanTxYZ71wDAl59iRRuWLwTGhvcPna5kfkTK8XEv9HJgObI/8XBo/5C3uRD5k48LGMBpYAUAbHh8TevpMa+zIfId/w4jHdr/6eTNIWDIu0SI/MvfZ+AaommaYcEyEobldSpUQ/x7BnbFiV/cL/sQOytdHn76IdmwIpkUwgBCEBzzIdfUeAE/+Ph/SrV/Z//f5Fa6tBAUCRHcc/NwtfMx27x/iVxR4wXsiAUBgGdLUgAL+GZy49VEHnKhgDnjgsgrbvRCc8YFkUdcGkbijAsiL7hwCc0ZF0Re4UQOIoWxgIkUxgImUpjy48CapiWF4CofLqrELuVhqhAfFfD+N3fJPkTTNJFMCgEuClXQ2z/bLvuQkrvUwTxwHqbK8UsBl7PeXQBAyd/2rj+V2KU8TH7Dz8BECqveGVjTNJGMi+CeIAwhvPkgdHH4DQBo2IGJj4HhyxOtTT9Yx5/nI3U5LGAHn1dzixgLCCDoVTfGBABcbsA8oKm18/TEsDdpELnESQGXvYhxxNnD3dGQLePhi8OYh+HL4BmYFOaXTqzqaPrBjsmbOwCgdZ13uRC5gJ1YRApjARMpjAVMpDAWMJHCWMBECmMBEymMBUykMBYwkcJYwEQKYwETKYwFXICmaYZlWZZh8KcEyd+0cr6i7XPZ3xl0QCSTk6tHcP0X8rVaLmCimsdLaCKFsYCJFMYCJlIYC5hIYSxgIoWxgIkUxgImUhgLmEhhLGAihbGAiRTGAiZSGAuYSGH/DwZ1sOziABMrAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>Some additional examples can be found in:</p>
<ul>
<li><a href="http://ncss-tech.github.io/AQP/aqp/genhz-distance-eval.html">Pair-Wise
Distances by Generalized Horizon Labels</a></li>
<li><a href="http://ncss-tech.github.io/AQP/soilDB/competing-series.html">Competing
Soil Series</a></li>
<li><a href="http://ncss-tech.github.io/AQP/aqp/aqp-profile-dissimilarity.html">Soil
Profile Distances</a></li>
</ul>
<hr />
<p>This document is based on <code>aqp</code> version 2.2.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
