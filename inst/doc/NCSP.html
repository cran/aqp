<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Numerical Classification of Soil Profiles</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Numerical Classification of Soil
Profiles</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>With the release of {aqp} 2.0, the soil profile comparison algorithm
implemented in <code>profile_compare()</code> (Beaudette et al., 2013)
has been completely re-written as <code>NCSP()</code> and re-named the
“Numerical Comparison of Soil Profiles”. A more recent discussion of
this algorithm is provided in Maynard et al. (2020).</p>
<p>This short vignette demonstrates how to use the <code>NCSP()</code>
function from {aqp} 2.x to perform a pair-wise comparison of soil data
encoded as a <code>SoilProfileCollection</code> object. The pair-wise
comparison of site-level attributes, previously available in
<code>profile_compare()</code> has been removed from <code>NCSP()</code>
and implemented as a stand-alone function named
<code>compareSites()</code>. A final distance matrix (combining horizon
and site level attributes) is created via weighted average. A more
detailed version of this vignette can be found in the <a href="https://ncss-tech.github.io/AQP/aqp/genhz-distance-eval.html">Pair-Wise
Distances by Generalized Horizon Labels</a> tutorial.</p>
</div>
<div id="a-simple-example" class="section level1">
<h1>A Simple Example</h1>
<p>Consider three soil profiles, containing basic morphology associated
with the <a href="https://casoilresource.lawr.ucdavis.edu/sde/?series=appling">Appling</a>,
<a href="https://casoilresource.lawr.ucdavis.edu/sde/?series=Bonneau">Bonneau</a>,
and <a href="https://casoilresource.lawr.ucdavis.edu/sde/?series=cecil">Cecil</a>
soil series. These data are provided in the example data set “osd” as
part of the {aqp} package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(aqp)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(cluster)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># load data and make a copy</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;osd&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> osd</span></code></pre></div>
<p>Simulation is used below to generate 4 realizations of each soil
series, using the <code>perturb()</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># assume a standard deviation of 10cm for horizon boundary depths</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># far too large for most horizons, but helps to make a point</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>x<span class="sc">$</span>hzd <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># generate 4 realizations of each soil profile in `x`</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co"># limit the minimum horizon thickness to 5cm</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10101</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">perturb</span>(x, <span class="at">id =</span> <span class="fu">sprintf</span>(<span class="st">&quot;sim-%02d&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>), <span class="at">boundary.attr =</span> <span class="st">&#39;hzd&#39;</span>, <span class="at">min.thickness =</span> <span class="dv">5</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co"># combine source + simulated data into a single SoilProfileCollection</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">combine</span>(x, s)</span></code></pre></div>
<p>A quick review of the source and simulated profiles, note patterns in
horizon depths, horizon designation, and moist soil colors. The profiles
have been visually truncated at 185cm for clarity (note ragged bottoms).
The new <code>.aqp.plotSPC.args</code> option is used to set default
arguments to <code>plotSPC()</code> for the remainder of the R session.
Simulated profiles are labeled with a numeric suffix (e.g. “-01”)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># set plotSPC argument defaults</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">options</span>(<span class="at">.aqp.plotSPC.args =</span> <span class="fu">list</span>(<span class="at">name.style =</span> <span class="st">&#39;center-center&#39;</span>, <span class="at">depth.axis =</span> <span class="fu">list</span>(<span class="at">style =</span> <span class="st">&#39;compact&#39;</span>, <span class="at">line =</span> <span class="sc">-</span><span class="fl">2.5</span>), <span class="at">width =</span> <span class="fl">0.33</span>, <span class="at">cex.names =</span> <span class="fl">0.75</span>, <span class="at">cex.id =</span> <span class="fl">0.66</span>, <span class="at">max.depth =</span> <span class="dv">185</span>))</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="fu">plotSPC</span>(z)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Subgroup level classification (encoded as an un-ordered factor) will
be used as a site-level attribute for computing pair-wise distances.
Quickly review the grouping structure with
<code>groupedProfilePlot()</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># encode as a factor for distance calculation</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>z<span class="sc">$</span>subgroup <span class="ot">&lt;-</span> <span class="fu">factor</span>(z<span class="sc">$</span>subgroup)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="fu">groupedProfilePlot</span>(z, <span class="at">groups =</span> <span class="st">&#39;subgroup&#39;</span>, <span class="at">group.name.offset =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">break.style =</span> <span class="st">&#39;arrow&#39;</span>, <span class="at">group.line.lty =</span> <span class="dv">1</span>, <span class="at">group.line.lwd =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Horizon designation, grouped into <a href="https://ncss-tech.github.io/AQP/aqp/gen-hz-assignment.html">“generalized
horizon labels”</a> will be used as the horizon-level attribute for
computing pair-wise distances. REGEX pattern matching is used to apply
generalized horizon labels (GHL) to each horizon, and are encoded as
ordered factors. A thematic soil profile sketch (horizon color defined
by a property or condition) is a convenient way to graphically check GHL
assignment.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># assign GHL</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>z<span class="sc">$</span>genhz <span class="ot">&lt;-</span> <span class="fu">generalize.hz</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  z<span class="sc">$</span>hzname, <span class="at">new =</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;E&#39;</span>, <span class="st">&#39;Bt&#39;</span>, <span class="st">&#39;C&#39;</span>), </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">pattern =</span> <span class="fu">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;E&#39;</span>, <span class="st">&#39;Bt&#39;</span>, <span class="st">&#39;C|Bt4&#39;</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co"># check GHL</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="fu">groupedProfilePlot</span>(z, <span class="at">groups =</span> <span class="st">&#39;subgroup&#39;</span>, <span class="at">group.name.offset =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">break.style =</span> <span class="st">&#39;arrow&#39;</span>, <span class="at">group.line.lty =</span> <span class="dv">1</span>, <span class="at">group.line.lwd =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&#39;genhz&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Define weights and compute separately horizon and site level distance
matrices. In this case, the site-level distances are give double the
weight as the horizon-level distances. See the manual pages
(<code>?NCSP</code> and <code>?compareSites</code>) for additional
arguments that can be used to further customize the comparison.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># horizon-level distance matrix weight</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>w1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co"># perform NCSP using only the GHL (ordered factors) to a depth of 185cm</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>d1 <span class="ot">&lt;-</span> <span class="fu">NCSP</span>(z, <span class="at">vars =</span> <span class="fu">c</span>(<span class="st">&#39;genhz&#39;</span>), <span class="at">maxDepth =</span> <span class="dv">185</span>, <span class="at">k =</span> <span class="dv">0</span>, <span class="at">rescaleResult =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co"># site-level distance matrix weight</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>w2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co"># Gower&#39;s distance metric applied to subgroup classification (nominal factor)</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">compareSites</span>(z, <span class="st">&#39;subgroup&#39;</span>)</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co"># perform weighted average of distance matrices</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>  <span class="st">`</span><span class="at">+</span><span class="st">`</span>, </span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  <span class="fu">list</span>(d1 <span class="sc">*</span> w1, d2 <span class="sc">*</span> w2)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">c</span>(w1, w2))</span></code></pre></div>
<p>Investigate the final distance matrix using divisive hierarchical
clustering. The <code>plotProfileDendrogram()</code> function is a
convenient way to combine the resulting dendrogram with soil profile
sketches. Note that the site-level distances have a very strong effect
on the overall clustering structure.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">library</span>(ape)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># divisive hierarchical clustering</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fu">as.hclust</span>(<span class="fu">diana</span>(D))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># hang soil profile sketches from resulting dendrogram</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="fu">plotProfileDendrogram</span>(z, <span class="at">clust =</span> h, <span class="at">scaling.factor =</span> <span class="fl">0.0075</span>, <span class="at">y.offset =</span> <span class="fl">0.15</span>, <span class="at">width =</span> <span class="fl">0.33</span>, <span class="at">color =</span> <span class="st">&#39;genhz&#39;</span>, <span class="at">name =</span> <span class="cn">NA</span>)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="co"># annotate dendrogram with subgroup classification</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="co"># this handy function provided by the ape package</span></span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="fu">tiplabels</span>(<span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)[z<span class="sc">$</span>subgroup], <span class="at">cex =</span> <span class="fl">1.5</span>, <span class="at">offset =</span> <span class="fl">0.05</span>)</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="co"># helpful legend</span></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="at">legend =</span> <span class="fu">levels</span>(z<span class="sc">$</span>subgroup), <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="at">bty =</span> <span class="st">&#39;n&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<ul>
<li>Beaudette, D.E., P. Roudier, and A.T. O’Geen. 2013. Algorithms for
quantitative pedology: A toolkit for soil scientists. Computers and
Geoscience 52:258-268.</li>
<li>Maynard, J.J., S.W. Salley, D.E. Beaudette, and J.E. Herrick. 2020.
Numerical soil classification supports soil identification by citizen
scientists using limited, simple soil observations. Soil Science Society
of America Journal 84:1675-1692.</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
